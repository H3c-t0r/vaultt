---
# ***
# WARNING: Do not EDIT or MERGE this file, it is generated by packagespec.
# ***

version: 2.1

executors:
  builder:
    docker:
      - image: circleci/buildpack-deps
    environment:
      PRODUCT_REVISION: ""
      AUTO_INSTALL_TOOLS: 'YES'
      BUILDKIT_PROGRESS: plain
    shell: /usr/bin/env bash -euo pipefail -c
  builder-machine:
    machine:
      image: ubuntu-1604:202007-01
    resource_class: xlarge
    environment:
      PRODUCT_REVISION: ""
      AUTO_INSTALL_TOOLS: 'YES'
      BUILDKIT_PROGRESS: plain
    shell: /usr/bin/env bash -euo pipefail -c

workflows:
  version: 2
  build-standalone:
    jobs:
      - build-common-layers
      - darwin_386_package: { requires: [ build-common-layers ] }
      - darwin_amd64_package: { requires: [ build-common-layers ] }
      - freebsd_386_package: { requires: [ build-common-layers ] }
      - freebsd_amd64_package: { requires: [ build-common-layers ] }
      - freebsd_arm_package: { requires: [ build-common-layers ] }
      - linux_386_package: { requires: [ build-common-layers ] }
      - linux_amd64_package: { requires: [ build-common-layers ] }
      - linux_arm_package: { requires: [ build-common-layers ] }
      - linux_arm64_package: { requires: [ build-common-layers ] }
      - netbsd_386_package: { requires: [ build-common-layers ] }
      - netbsd_amd64_package: { requires: [ build-common-layers ] }
      - openbsd_386_package: { requires: [ build-common-layers ] }
      - openbsd_amd64_package: { requires: [ build-common-layers ] }
      - solaris_amd64_package: { requires: [ build-common-layers ] }
      - windows_386_package: { requires: [ build-common-layers ] }
      - windows_amd64_package: { requires: [ build-common-layers ] }
      - bundle-releases:
          requires:
            - darwin_386_package
            - darwin_amd64_package
            - freebsd_386_package
            - freebsd_amd64_package
            - freebsd_arm_package
            - linux_386_package
            - linux_amd64_package
            - linux_arm_package
            - linux_arm64_package
            - netbsd_386_package
            - netbsd_amd64_package
            - openbsd_386_package
            - openbsd_amd64_package
            - solaris_amd64_package
            - windows_386_package
            - windows_amd64_package
jobs:
  build-common-layers:
    executor: builder-machine
    steps:
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"

      - checkout
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build image cache
          keys:
            - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
            - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
            - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
            - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
            - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
            - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
            - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Finish early if loaded exact match from cache.
          command: |
            if [ -f .buildcache/archives/06-build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab.tar.gz ]; then
              echo "Exact match found in cache, skipping build."
              circleci-agent step halt
            else
              echo "No exact match found, proceeding with build."
            fi
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            LAYER_SPEC_ID=06-build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab make -C packages*.lock load-builder-cache
      - run:
          name: Build base layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 00-base-cd50335c2217aa98d45d50d7ef941dfd1289b070-image
      - run:
          name: Build install-go layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 01-install-go-5930dc1372dd850c52023131f54400cf580fc2fc-image
      - run:
          name: Build install-go-tools layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 02-install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9-image
      - run:
          name: Build set-workdir layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 03-set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814-image
      - run:
          name: Build install-yarn layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 04-install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8-image
      - run:
          name: Build ui-dependencies layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 05-ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd-image
      - run:
          name: Build build-ui layer
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -f packages*.lock/layer.mk 06-build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab-image

      - run:
          name: Export builder image
          command: make -f packages*.lock/layer.mk 06-build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab-save
      - save_cache:
          name: Save layer build-ui to cache.
          key: cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          paths:
            - .buildcache/archives/06-build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab.tar.gz
      - run:
          name: Prepare layer ui-dependencies for caching
          command: mv .buildcache/archives/06-build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab.tar.gz .buildcache/archives/05-ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd.tar.gz
      - save_cache:
          name: Save layer ui-dependencies to cache.
          key: cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          paths:
            - .buildcache/archives/05-ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd.tar.gz
      - run:
          name: Prepare layer install-yarn for caching
          command: mv .buildcache/archives/05-ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd.tar.gz .buildcache/archives/04-install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8.tar.gz
      - save_cache:
          name: Save layer install-yarn to cache.
          key: cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          paths:
            - .buildcache/archives/04-install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8.tar.gz
      - run:
          name: Prepare layer set-workdir for caching
          command: mv .buildcache/archives/04-install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8.tar.gz .buildcache/archives/03-set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814.tar.gz
      - save_cache:
          name: Save layer set-workdir to cache.
          key: cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          paths:
            - .buildcache/archives/03-set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814.tar.gz
      - run:
          name: Prepare layer install-go-tools for caching
          command: mv .buildcache/archives/03-set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814.tar.gz .buildcache/archives/02-install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9.tar.gz
      - save_cache:
          name: Save layer install-go-tools to cache.
          key: cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          paths:
            - .buildcache/archives/02-install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9.tar.gz
      - run:
          name: Prepare layer install-go for caching
          command: mv .buildcache/archives/02-install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9.tar.gz .buildcache/archives/01-install-go-5930dc1372dd850c52023131f54400cf580fc2fc.tar.gz
      - save_cache:
          name: Save layer install-go to cache.
          key: cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          paths:
            - .buildcache/archives/01-install-go-5930dc1372dd850c52023131f54400cf580fc2fc.tar.gz
      - run:
          name: Prepare layer base for caching
          command: mv .buildcache/archives/01-install-go-5930dc1372dd850c52023131f54400cf580fc2fc.tar.gz .buildcache/archives/00-base-cd50335c2217aa98d45d50d7ef941dfd1289b070.tar.gz
      - save_cache:
          name: Save layer base to cache.
          key: cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
          paths:
            - .buildcache/archives/00-base-cd50335c2217aa98d45d50d7ef941dfd1289b070.tar.gz
  darwin_386_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 8dab6563337efbae083d6506070531ba8d60a00a
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-8dab6563337efbae083d6506070531ba8d60a00a-{{checksum ".buildcache/cache-keys/package-8dab6563337efbae083d6506070531ba8d60a00a"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_b34b_{{checksum ".buildcache/cache-keys/copy-source-b34b4bbf150073209a7291ec5b06b40588f7afff"}}
          - cache006-warm-go-build-vendor-cache_a5ae_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-a5aeaccdcefd75ed4702e78424b011a1ea1341d7"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-8dab6563337efbae083d6506070531ba8d60a00a-{{checksum ".buildcache/cache-keys/package-8dab6563337efbae083d6506070531ba8d60a00a"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-a5aeaccdcefd75ed4702e78424b011a1ea1341d7.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-a5aeaccdcefd75ed4702e78424b011a1ea1341d7-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_a5ae_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-a5aeaccdcefd75ed4702e78424b011a1ea1341d7"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-a5aeaccdcefd75ed4702e78424b011a1ea1341d7.tar.gz

  darwin_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: b168b39a60e04bc61fb04bc5769f1e73f11672d5
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-b168b39a60e04bc61fb04bc5769f1e73f11672d5-{{checksum ".buildcache/cache-keys/package-b168b39a60e04bc61fb04bc5769f1e73f11672d5"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_8949_{{checksum ".buildcache/cache-keys/copy-source-89499358c51a9c33317060748e17b8bbd2e1c9ad"}}
          - cache006-warm-go-build-vendor-cache_6e42_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-6e42f890ba16e79057b483ee075be92b88003a86"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-b168b39a60e04bc61fb04bc5769f1e73f11672d5-{{checksum ".buildcache/cache-keys/package-b168b39a60e04bc61fb04bc5769f1e73f11672d5"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-6e42f890ba16e79057b483ee075be92b88003a86.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-6e42f890ba16e79057b483ee075be92b88003a86-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_6e42_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-6e42f890ba16e79057b483ee075be92b88003a86"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-6e42f890ba16e79057b483ee075be92b88003a86.tar.gz

  freebsd_386_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 6787b0cdac44e8c4a5b5e17557f1d594d64b43e0
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-6787b0cdac44e8c4a5b5e17557f1d594d64b43e0-{{checksum ".buildcache/cache-keys/package-6787b0cdac44e8c4a5b5e17557f1d594d64b43e0"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_2d94_{{checksum ".buildcache/cache-keys/copy-source-2d94fd91b1d15153b3b921536947b046e9003747"}}
          - cache006-warm-go-build-vendor-cache_2829_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-282990ba92770ec199d835955fbceb18fbb4319c"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-6787b0cdac44e8c4a5b5e17557f1d594d64b43e0-{{checksum ".buildcache/cache-keys/package-6787b0cdac44e8c4a5b5e17557f1d594d64b43e0"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-282990ba92770ec199d835955fbceb18fbb4319c.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-282990ba92770ec199d835955fbceb18fbb4319c-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_2829_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-282990ba92770ec199d835955fbceb18fbb4319c"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-282990ba92770ec199d835955fbceb18fbb4319c.tar.gz

  freebsd_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 57691f7fb47d56b184a52f05916aa77423f90892
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-57691f7fb47d56b184a52f05916aa77423f90892-{{checksum ".buildcache/cache-keys/package-57691f7fb47d56b184a52f05916aa77423f90892"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_4bd4_{{checksum ".buildcache/cache-keys/copy-source-4bd46cde42512c58b661d4e28d81b20cc7256a64"}}
          - cache006-warm-go-build-vendor-cache_01eb_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-01eb738d113fde4b24a9590821862f106b9eba9c"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-57691f7fb47d56b184a52f05916aa77423f90892-{{checksum ".buildcache/cache-keys/package-57691f7fb47d56b184a52f05916aa77423f90892"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-01eb738d113fde4b24a9590821862f106b9eba9c.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-01eb738d113fde4b24a9590821862f106b9eba9c-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_01eb_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-01eb738d113fde4b24a9590821862f106b9eba9c"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-01eb738d113fde4b24a9590821862f106b9eba9c.tar.gz

  freebsd_arm_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 6d4c1bb1f543d760e07fea30a68691e887e8f1dd
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-6d4c1bb1f543d760e07fea30a68691e887e8f1dd-{{checksum ".buildcache/cache-keys/package-6d4c1bb1f543d760e07fea30a68691e887e8f1dd"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_b449_{{checksum ".buildcache/cache-keys/copy-source-b449e30e6ca8434b0e7411183531440b9daba5c2"}}
          - cache006-warm-go-build-vendor-cache_775a_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-775ac7a4157ee5ff0c89fde5e02c5e187a2db1e1"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-6d4c1bb1f543d760e07fea30a68691e887e8f1dd-{{checksum ".buildcache/cache-keys/package-6d4c1bb1f543d760e07fea30a68691e887e8f1dd"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-775ac7a4157ee5ff0c89fde5e02c5e187a2db1e1.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-775ac7a4157ee5ff0c89fde5e02c5e187a2db1e1-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_775a_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-775ac7a4157ee5ff0c89fde5e02c5e187a2db1e1"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-775ac7a4157ee5ff0c89fde5e02c5e187a2db1e1.tar.gz

  linux_386_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 460a653156e2cf5357cd8822a436d084f45de864
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-460a653156e2cf5357cd8822a436d084f45de864-{{checksum ".buildcache/cache-keys/package-460a653156e2cf5357cd8822a436d084f45de864"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_43e9_{{checksum ".buildcache/cache-keys/copy-source-43e92d7d36b6626653177298e39adffbd405b421"}}
          - cache006-warm-go-build-vendor-cache_760c_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-760cd45f95dcdbec5318705331a0aedf6f0b813b"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-460a653156e2cf5357cd8822a436d084f45de864-{{checksum ".buildcache/cache-keys/package-460a653156e2cf5357cd8822a436d084f45de864"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-760cd45f95dcdbec5318705331a0aedf6f0b813b.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-760cd45f95dcdbec5318705331a0aedf6f0b813b-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_760c_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-760cd45f95dcdbec5318705331a0aedf6f0b813b"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-760cd45f95dcdbec5318705331a0aedf6f0b813b.tar.gz

  linux_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 19e6736ac888a3b2ec8c1838ad61ca1c137e5003
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-19e6736ac888a3b2ec8c1838ad61ca1c137e5003-{{checksum ".buildcache/cache-keys/package-19e6736ac888a3b2ec8c1838ad61ca1c137e5003"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_95da_{{checksum ".buildcache/cache-keys/copy-source-95da59d4306046b90b790089e83193e9a6df9fd6"}}
          - cache006-warm-go-build-vendor-cache_d91b_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-d91b7e2ff4a0d632878b26727b4e7b6f24b42997"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-19e6736ac888a3b2ec8c1838ad61ca1c137e5003-{{checksum ".buildcache/cache-keys/package-19e6736ac888a3b2ec8c1838ad61ca1c137e5003"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-d91b7e2ff4a0d632878b26727b4e7b6f24b42997.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-d91b7e2ff4a0d632878b26727b4e7b6f24b42997-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_d91b_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-d91b7e2ff4a0d632878b26727b4e7b6f24b42997"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-d91b7e2ff4a0d632878b26727b4e7b6f24b42997.tar.gz

  linux_arm_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: d094813728a1baea822b732b75add0b5be832313
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-d094813728a1baea822b732b75add0b5be832313-{{checksum ".buildcache/cache-keys/package-d094813728a1baea822b732b75add0b5be832313"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_1cee_{{checksum ".buildcache/cache-keys/copy-source-1ceeff19e616507c1735b7bfa2b5695042cf94be"}}
          - cache006-warm-go-build-vendor-cache_0b15_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-0b153ca8c99dbe0768e298da203850249d2c3edd"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-d094813728a1baea822b732b75add0b5be832313-{{checksum ".buildcache/cache-keys/package-d094813728a1baea822b732b75add0b5be832313"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-0b153ca8c99dbe0768e298da203850249d2c3edd.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-0b153ca8c99dbe0768e298da203850249d2c3edd-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_0b15_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-0b153ca8c99dbe0768e298da203850249d2c3edd"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-0b153ca8c99dbe0768e298da203850249d2c3edd.tar.gz

  linux_arm64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 55bb926a6afd1d74079519a2cff92ac2d776b1d8
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-55bb926a6afd1d74079519a2cff92ac2d776b1d8-{{checksum ".buildcache/cache-keys/package-55bb926a6afd1d74079519a2cff92ac2d776b1d8"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_0ee9_{{checksum ".buildcache/cache-keys/copy-source-0ee900581e504825d238f242fc6048e38c12d9a8"}}
          - cache006-warm-go-build-vendor-cache_ee17_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-ee177f96899b87e8403f1adae55f80e259a36e2c"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-55bb926a6afd1d74079519a2cff92ac2d776b1d8-{{checksum ".buildcache/cache-keys/package-55bb926a6afd1d74079519a2cff92ac2d776b1d8"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-ee177f96899b87e8403f1adae55f80e259a36e2c.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-ee177f96899b87e8403f1adae55f80e259a36e2c-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_ee17_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-ee177f96899b87e8403f1adae55f80e259a36e2c"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-ee177f96899b87e8403f1adae55f80e259a36e2c.tar.gz

  netbsd_386_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: a653448b53b3b51b9335f95dea72bfb207539cf2
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-a653448b53b3b51b9335f95dea72bfb207539cf2-{{checksum ".buildcache/cache-keys/package-a653448b53b3b51b9335f95dea72bfb207539cf2"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_54d3_{{checksum ".buildcache/cache-keys/copy-source-54d3d59865a6b91a0d6f476076bf00e2edb59b06"}}
          - cache006-warm-go-build-vendor-cache_13da_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-13daa007ac837196b1cb097e80d22a332f41c42d"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-a653448b53b3b51b9335f95dea72bfb207539cf2-{{checksum ".buildcache/cache-keys/package-a653448b53b3b51b9335f95dea72bfb207539cf2"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-13daa007ac837196b1cb097e80d22a332f41c42d.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-13daa007ac837196b1cb097e80d22a332f41c42d-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_13da_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-13daa007ac837196b1cb097e80d22a332f41c42d"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-13daa007ac837196b1cb097e80d22a332f41c42d.tar.gz

  netbsd_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 31945922764a1c74d6b5fd184de0dee4b2a37e69
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-31945922764a1c74d6b5fd184de0dee4b2a37e69-{{checksum ".buildcache/cache-keys/package-31945922764a1c74d6b5fd184de0dee4b2a37e69"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_63bf_{{checksum ".buildcache/cache-keys/copy-source-63bffc132b498bbb29801a383aedbe3fbf2db686"}}
          - cache006-warm-go-build-vendor-cache_de6a_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-de6ab3a9b673a36dc3cb38120ec1246c6f992440"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-31945922764a1c74d6b5fd184de0dee4b2a37e69-{{checksum ".buildcache/cache-keys/package-31945922764a1c74d6b5fd184de0dee4b2a37e69"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-de6ab3a9b673a36dc3cb38120ec1246c6f992440.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-de6ab3a9b673a36dc3cb38120ec1246c6f992440-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_de6a_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-de6ab3a9b673a36dc3cb38120ec1246c6f992440"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-de6ab3a9b673a36dc3cb38120ec1246c6f992440.tar.gz

  openbsd_386_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: e8b2fee0f071585941c5f549ff7fb9fd2c2e3825
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-e8b2fee0f071585941c5f549ff7fb9fd2c2e3825-{{checksum ".buildcache/cache-keys/package-e8b2fee0f071585941c5f549ff7fb9fd2c2e3825"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_afa5_{{checksum ".buildcache/cache-keys/copy-source-afa5feb4a81d321a612b575f2f445b1782ac50c5"}}
          - cache006-warm-go-build-vendor-cache_2b81_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-2b81c09aabf36ba4806e97b3f5cd53acfcb5f03b"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-e8b2fee0f071585941c5f549ff7fb9fd2c2e3825-{{checksum ".buildcache/cache-keys/package-e8b2fee0f071585941c5f549ff7fb9fd2c2e3825"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-2b81c09aabf36ba4806e97b3f5cd53acfcb5f03b.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-2b81c09aabf36ba4806e97b3f5cd53acfcb5f03b-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_2b81_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-2b81c09aabf36ba4806e97b3f5cd53acfcb5f03b"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-2b81c09aabf36ba4806e97b3f5cd53acfcb5f03b.tar.gz

  openbsd_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: d36cd264d651ec8fe646c3494c2b28bec1274450
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-d36cd264d651ec8fe646c3494c2b28bec1274450-{{checksum ".buildcache/cache-keys/package-d36cd264d651ec8fe646c3494c2b28bec1274450"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_a6ba_{{checksum ".buildcache/cache-keys/copy-source-a6ba740283e691ef10521bf5da25c0fabd2bd066"}}
          - cache006-warm-go-build-vendor-cache_1b6f_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-1b6fda2804df1135a27deec1b79fdb8944654d14"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-d36cd264d651ec8fe646c3494c2b28bec1274450-{{checksum ".buildcache/cache-keys/package-d36cd264d651ec8fe646c3494c2b28bec1274450"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-1b6fda2804df1135a27deec1b79fdb8944654d14.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-1b6fda2804df1135a27deec1b79fdb8944654d14-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_1b6f_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-1b6fda2804df1135a27deec1b79fdb8944654d14"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-1b6fda2804df1135a27deec1b79fdb8944654d14.tar.gz

  solaris_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 1c75afa38740f1e706cdf4d8fee9a59166fc9e8f
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-1c75afa38740f1e706cdf4d8fee9a59166fc9e8f-{{checksum ".buildcache/cache-keys/package-1c75afa38740f1e706cdf4d8fee9a59166fc9e8f"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_215d_{{checksum ".buildcache/cache-keys/copy-source-215dae7ebc04d0ac45cc8eb4ccfb39f1dec90ea0"}}
          - cache006-warm-go-build-vendor-cache_27c6_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-27c64188811d5b42afb14085b4142a7fb68b408d"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-1c75afa38740f1e706cdf4d8fee9a59166fc9e8f-{{checksum ".buildcache/cache-keys/package-1c75afa38740f1e706cdf4d8fee9a59166fc9e8f"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-27c64188811d5b42afb14085b4142a7fb68b408d.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-27c64188811d5b42afb14085b4142a7fb68b408d-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_27c6_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-27c64188811d5b42afb14085b4142a7fb68b408d"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-27c64188811d5b42afb14085b4142a7fb68b408d.tar.gz

  windows_386_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: a9dc544759833cc8ef096fb72819bda56df669d3
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-a9dc544759833cc8ef096fb72819bda56df669d3-{{checksum ".buildcache/cache-keys/package-a9dc544759833cc8ef096fb72819bda56df669d3"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_56b4_{{checksum ".buildcache/cache-keys/copy-source-56b4fcded8ff8f2b1c5add5d77bd1586953202cb"}}
          - cache006-warm-go-build-vendor-cache_a688_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-a6880af013bb8f579cc33ac5ea020eab1db0597e"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-a9dc544759833cc8ef096fb72819bda56df669d3-{{checksum ".buildcache/cache-keys/package-a9dc544759833cc8ef096fb72819bda56df669d3"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-a6880af013bb8f579cc33ac5ea020eab1db0597e.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-a6880af013bb8f579cc33ac5ea020eab1db0597e-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_a688_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-a6880af013bb8f579cc33ac5ea020eab1db0597e"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-a6880af013bb8f579cc33ac5ea020eab1db0597e.tar.gz

  windows_amd64_package:
    executor: builder
    environment:
      - PACKAGE_SPEC_ID: 5251d88e8d819c1af5e3086c5ee6d5691984f4bb
    steps:
      
      - setup_remote_docker:
          version: 19.03.12
      
      - add_ssh_keys:
          fingerprints:
            # hashicorp-ci github user.
            - "c6:96:98:82:dc:04:6c:39:dd:ac:83:05:e3:15:1c:98"


      - checkout

      # Restore the package cache first, we might not need to rebuild.
      - write-package-cache-key
      - restore_cache:
          name: Restore package cache
          key: 'cache006-package-5251d88e8d819c1af5e3086c5ee6d5691984f4bb-{{checksum ".buildcache/cache-keys/package-5251d88e8d819c1af5e3086c5ee6d5691984f4bb"}}'
      - run:
          name: Check the cache status.
          command: |
            if ! { PKG=$(find .buildcache/packages/store -maxdepth 1 -mindepth 1 -name '*.zip' 2> /dev/null) && [ -n "$PKG" ]; }; then
              echo "No package found, continuing with build."
              exit 0
            fi
            echo "Package already cached, skipping build."
            circleci-agent step halt

      # We need to rebuild, so load the builder cache.
      - write-build-layer-cache-keys
      - restore_cache:
          name: Restore build layer cache
          keys:
          - cache006-copy-source_be15_{{checksum ".buildcache/cache-keys/copy-source-be150dcf8267e6070894253e0369c9daa9b79482"}}
          - cache006-warm-go-build-vendor-cache_ec9a_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-ec9a0231e5fe94fd57abbb30d8d7bf9f0a6c1100"}}
          - cache006-build-static-assets_ec92_{{checksum ".buildcache/cache-keys/build-static-assets-ec92c380ceaa38acfdcf8d7ed1d765ed6f86a24b"}}
          - cache006-build-ui_f309_{{checksum ".buildcache/cache-keys/build-ui-f309c2887be9d620c0fb94d4babcc4745deb6fab"}}
          - cache006-ui-dependencies_1490_{{checksum ".buildcache/cache-keys/ui-dependencies-1490c4a5fa9891204ead666fa1e1fdc256adb0cd"}}
          - cache006-install-yarn_215c_{{checksum ".buildcache/cache-keys/install-yarn-215ccd00047a9d2cce5cdb149d71c12f47075ae8"}}
          - cache006-set-workdir_8388_{{checksum ".buildcache/cache-keys/set-workdir-8388e9e97391d59736fa011dace5ce3c3ca40814"}}
          - cache006-install-go-tools_4b19_{{checksum ".buildcache/cache-keys/install-go-tools-4b195451ff10d354581261b5ac73f6cd3473a1b9"}}
          - cache006-install-go_5930_{{checksum ".buildcache/cache-keys/install-go-5930dc1372dd850c52023131f54400cf580fc2fc"}}
          - cache006-base_cd50_{{checksum ".buildcache/cache-keys/base-cd50335c2217aa98d45d50d7ef941dfd1289b070"}}
      - run:
          name: Load whatever builder cache we have (if any) into the Docker daemon
          no_output_timeout: 30m
          command: |
            make -C packages*.lock load-builder-cache

      - run:
          name: Compile Package
          command: |
            
            KEYFILE="$HOME/.ssh/id_rsa_c6969882dc046c39ddac8305e3151c98"
            eval "$(ssh-agent -s)"
            if [ -f "$KEYFILE" ]; then
              ssh-add "$KEYFILE"
            else
              echo "==> INFO: SSH key for github.com not found"
              echo "    Attempts to access private repositories from within"
              echo "    the build will fail, e.g. for private go modules, or"
              echo "    attempts to directly clone private repositories."
            fi

            make -C packages*.lock package

      - run:
          name: List packages
          command: ls -lahR .buildcache/packages
      - save_cache:
          name: Saving package cache
          key: 'cache006-package-5251d88e8d819c1af5e3086c5ee6d5691984f4bb-{{checksum ".buildcache/cache-keys/package-5251d88e8d819c1af5e3086c5ee6d5691984f4bb"}}'
          paths:
            - .buildcache/packages/store
      # Save builder image cache if necessary.
      # The range should only iterate over a single layer.
      - run:
          name: Check builder cache status
          command: |
            if [ -f .buildcache/archives/08-warm-go-build-vendor-cache-ec9a0231e5fe94fd57abbb30d8d7bf9f0a6c1100.tar.gz ]; then
              echo "Builder image already cached, skipping cache step."
              circleci-agent step halt
            fi
      - run:
          name: Prepare build layers for caching
          command: make -f packages*.lock/layer.mk 08-warm-go-build-vendor-cache-ec9a0231e5fe94fd57abbb30d8d7bf9f0a6c1100-save
      - save_cache:
          name: Save build layer cache
          key: 'cache006-warm-go-build-vendor-cache_ec9a_{{checksum ".buildcache/cache-keys/warm-go-build-vendor-cache-ec9a0231e5fe94fd57abbb30d8d7bf9f0a6c1100"}}'
          paths:
            - .buildcache/archives/08-warm-go-build-vendor-cache-ec9a0231e5fe94fd57abbb30d8d7bf9f0a6c1100.tar.gz


  bundle-releases:
    executor: builder
    steps:
      - checkout
      - write-all-package-cache-keys
      - load-darwin_386_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 8dab6563337efbae083d6506070531ba8d60a00a
          name: Write package metadata for darwin_386_package
          command: |
            make package-meta
      - load-darwin_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: b168b39a60e04bc61fb04bc5769f1e73f11672d5
          name: Write package metadata for darwin_amd64_package
          command: |
            make package-meta
      - load-freebsd_386_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 6787b0cdac44e8c4a5b5e17557f1d594d64b43e0
          name: Write package metadata for freebsd_386_package
          command: |
            make package-meta
      - load-freebsd_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 57691f7fb47d56b184a52f05916aa77423f90892
          name: Write package metadata for freebsd_amd64_package
          command: |
            make package-meta
      - load-freebsd_arm_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 6d4c1bb1f543d760e07fea30a68691e887e8f1dd
          name: Write package metadata for freebsd_arm_package
          command: |
            make package-meta
      - load-linux_386_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 460a653156e2cf5357cd8822a436d084f45de864
          name: Write package metadata for linux_386_package
          command: |
            make package-meta
      - load-linux_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 19e6736ac888a3b2ec8c1838ad61ca1c137e5003
          name: Write package metadata for linux_amd64_package
          command: |
            make package-meta
      - load-linux_arm_package
      - run:
          environment:
            PACKAGE_SPEC_ID: d094813728a1baea822b732b75add0b5be832313
          name: Write package metadata for linux_arm_package
          command: |
            make package-meta
      - load-linux_arm64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 55bb926a6afd1d74079519a2cff92ac2d776b1d8
          name: Write package metadata for linux_arm64_package
          command: |
            make package-meta
      - load-netbsd_386_package
      - run:
          environment:
            PACKAGE_SPEC_ID: a653448b53b3b51b9335f95dea72bfb207539cf2
          name: Write package metadata for netbsd_386_package
          command: |
            make package-meta
      - load-netbsd_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 31945922764a1c74d6b5fd184de0dee4b2a37e69
          name: Write package metadata for netbsd_amd64_package
          command: |
            make package-meta
      - load-openbsd_386_package
      - run:
          environment:
            PACKAGE_SPEC_ID: e8b2fee0f071585941c5f549ff7fb9fd2c2e3825
          name: Write package metadata for openbsd_386_package
          command: |
            make package-meta
      - load-openbsd_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: d36cd264d651ec8fe646c3494c2b28bec1274450
          name: Write package metadata for openbsd_amd64_package
          command: |
            make package-meta
      - load-solaris_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 1c75afa38740f1e706cdf4d8fee9a59166fc9e8f
          name: Write package metadata for solaris_amd64_package
          command: |
            make package-meta
      - load-windows_386_package
      - run:
          environment:
            PACKAGE_SPEC_ID: a9dc544759833cc8ef096fb72819bda56df669d3
          name: Write package metadata for windows_386_package
          command: |
            make package-meta
      - load-windows_amd64_package
      - run:
          environment:
            PACKAGE_SPEC_ID: 5251d88e8d819c1af5e3086c5ee6d5691984f4bb
          name: Write package metadata for windows_amd64_package
          command: |
            make package-meta
      - run:
          name: Write package aliases
          command:
            make aliases
      - run:
          name: List Build Cache
          command: ls -lahR .buildcache

      # Give the lockfile a name store_artifacts can work with.
      - run: cp packages*.lock/pkgs.yml lockfile-standalone.yml

      # Surface the lock file as an artifact.
      - store_artifacts:
          path: lockfile-standalone.yml
          destination: lockfile-standalone.yml

      # Surface the package store directory as an artifact.
      # This makes each zipped package separately downloadable.
      - store_artifacts:
          path: .buildcache/packages
          destination: packages-standalone

      # Surface a tarball of the whole package store plus lockfile as an artifact.
      - run: tar -czf packages-standalone.tar.gz .buildcache/packages lockfile-standalone.yml
      - store_artifacts:
          path: packages-standalone.tar.gz
          destination: packages-standalone.tar.gz

      # Surface a tarball of just the metadata files.
      - run: tar -czf meta-standalone.tar.gz .buildcache/packages/store/*.json lockfile-standalone.yml
      - store_artifacts:
          path: meta-standalone.tar.gz
          destination: meta-standalone.tar.gz

commands:
  load-darwin_386_package:
    steps:
      - restore_cache:
          key: 'cache006-package-8dab6563337efbae083d6506070531ba8d60a00a-{{checksum ".buildcache/cache-keys/package-8dab6563337efbae083d6506070531ba8d60a00a"}}'
  
  load-darwin_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-b168b39a60e04bc61fb04bc5769f1e73f11672d5-{{checksum ".buildcache/cache-keys/package-b168b39a60e04bc61fb04bc5769f1e73f11672d5"}}'
  
  load-freebsd_386_package:
    steps:
      - restore_cache:
          key: 'cache006-package-6787b0cdac44e8c4a5b5e17557f1d594d64b43e0-{{checksum ".buildcache/cache-keys/package-6787b0cdac44e8c4a5b5e17557f1d594d64b43e0"}}'
  
  load-freebsd_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-57691f7fb47d56b184a52f05916aa77423f90892-{{checksum ".buildcache/cache-keys/package-57691f7fb47d56b184a52f05916aa77423f90892"}}'
  
  load-freebsd_arm_package:
    steps:
      - restore_cache:
          key: 'cache006-package-6d4c1bb1f543d760e07fea30a68691e887e8f1dd-{{checksum ".buildcache/cache-keys/package-6d4c1bb1f543d760e07fea30a68691e887e8f1dd"}}'
  
  load-linux_386_package:
    steps:
      - restore_cache:
          key: 'cache006-package-460a653156e2cf5357cd8822a436d084f45de864-{{checksum ".buildcache/cache-keys/package-460a653156e2cf5357cd8822a436d084f45de864"}}'
  
  load-linux_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-19e6736ac888a3b2ec8c1838ad61ca1c137e5003-{{checksum ".buildcache/cache-keys/package-19e6736ac888a3b2ec8c1838ad61ca1c137e5003"}}'
  
  load-linux_arm_package:
    steps:
      - restore_cache:
          key: 'cache006-package-d094813728a1baea822b732b75add0b5be832313-{{checksum ".buildcache/cache-keys/package-d094813728a1baea822b732b75add0b5be832313"}}'
  
  load-linux_arm64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-55bb926a6afd1d74079519a2cff92ac2d776b1d8-{{checksum ".buildcache/cache-keys/package-55bb926a6afd1d74079519a2cff92ac2d776b1d8"}}'
  
  load-netbsd_386_package:
    steps:
      - restore_cache:
          key: 'cache006-package-a653448b53b3b51b9335f95dea72bfb207539cf2-{{checksum ".buildcache/cache-keys/package-a653448b53b3b51b9335f95dea72bfb207539cf2"}}'
  
  load-netbsd_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-31945922764a1c74d6b5fd184de0dee4b2a37e69-{{checksum ".buildcache/cache-keys/package-31945922764a1c74d6b5fd184de0dee4b2a37e69"}}'
  
  load-openbsd_386_package:
    steps:
      - restore_cache:
          key: 'cache006-package-e8b2fee0f071585941c5f549ff7fb9fd2c2e3825-{{checksum ".buildcache/cache-keys/package-e8b2fee0f071585941c5f549ff7fb9fd2c2e3825"}}'
  
  load-openbsd_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-d36cd264d651ec8fe646c3494c2b28bec1274450-{{checksum ".buildcache/cache-keys/package-d36cd264d651ec8fe646c3494c2b28bec1274450"}}'
  
  load-solaris_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-1c75afa38740f1e706cdf4d8fee9a59166fc9e8f-{{checksum ".buildcache/cache-keys/package-1c75afa38740f1e706cdf4d8fee9a59166fc9e8f"}}'
  
  load-windows_386_package:
    steps:
      - restore_cache:
          key: 'cache006-package-a9dc544759833cc8ef096fb72819bda56df669d3-{{checksum ".buildcache/cache-keys/package-a9dc544759833cc8ef096fb72819bda56df669d3"}}'
  
  load-windows_amd64_package:
    steps:
      - restore_cache:
          key: 'cache006-package-5251d88e8d819c1af5e3086c5ee6d5691984f4bb-{{checksum ".buildcache/cache-keys/package-5251d88e8d819c1af5e3086c5ee6d5691984f4bb"}}'
  

  write-build-layer-cache-keys:
    steps:
      - run:
          name: Write builder layer cache keys
          command: make -C packages*.lock write-builder-cache-keys

  write-package-cache-key:
    steps:
      - run:
          name: Write package cache key
          command: make -C packages*.lock write-package-cache-key

  write-all-package-cache-keys:
    steps:
      - run:
          name: Write all package cache keys
          command: make -C packages*.lock write-all-package-cache-keys
