executor: node
resource_class: xlarge
steps:
  - checkout
  - restore_yarn_cache
  - attach_workspace:
      at: .
  - run:
      name: export PATH
      command: |
        # Add ./bin to the PATH so vault binary can be run by Ember tests
        set -x
        export PATH="${PWD}/bin:${PATH}"
  - run:
      name: Ember tests
      command: mkdir -p /tmp/test-reports && cd ui && yarn test:oss
  - store_test_results:
      path: /tmp/test-reports
  - store_artifacts:
      path: /tmp/test-reports
