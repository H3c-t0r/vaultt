package kafka

import "testing"

func Test_producerConfig(t *testing.T) {
	config := map[string]string{}
	_, err := producerFromConfig(config)

	if err != nil {
		t.Errorf("Config is valid, but got an error:\n%s", err)
	}
}

func Test_TLSproducerConfig(t *testing.T) {
	config := map[string]string{
		"ca_cert": `-----BEGIN CERTIFICATE-----
MIIDOzCCAiOgAwIBAgIUTWZ5MbCZwnf6CO2hLx2oc5VKqaYwDQYJKoZIhvcNAQEL
BQAwGDEWMBQGA1UEAxMNa2Fma2EtY2x1c3RlcjAeFw0xOTAxMDIxNTA5MTFaFw0x
OTAyMDMxNTA5NDBaMBgxFjAUBgNVBAMTDWthZmthLWNsdXN0ZXIwggEiMA0GCSqG
SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDDtn5SQQY4wksl1ImzOFWfkpM5CONRx7oN
P7M5RuYibDov2IIIreW1e8VtzAEbhDzpeystxIW3UQrPXHA0tWtHJ/Kjdg+loUQ5
m0S/z0cCT3TQw4Sz3zCloG9dtgP5w3hS3AlpvD6Rysl2/O6zdqO1aqp7f8COBWiT
aehWAbe8ECsBypbEaPauo8nwP22QskBARcYY/VfQ4z22XRkUdUovxMPBG6oJGOKx
I+XH4rCiZQD8iw4zt8Yk75la3HAhPGQJHD4vpgxSX7WjelZx3Vjp2+uwb3coo6yR
z1RbN7BnKIamPN7xky/uIGi9bCbQ4TGdu1o0c6u2FhHL/OdMKJ6vAgMBAAGjfTB7
MA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBTutNph
bt9ucsDqA8nBIuS6QWtO9TAfBgNVHSMEGDAWgBTutNphbt9ucsDqA8nBIuS6QWtO
9TAYBgNVHREEETAPgg1rYWZrYS1jbHVzdGVyMA0GCSqGSIb3DQEBCwUAA4IBAQCY
7GEEhzAg2QCgJlCc8RSsWhThSO4ED9qOOAMYZCIttRBmjF/CDXfOiC7XBmdegl8m
grVdwsNNzcAwhZZYPm2HVvsq3iFaArrsdPlkAU554pZPRiX941ULE6hWpK2p/uwL
kXCuagLASUFO1Jgntyb3u7jEa8izlphrTmwze0MTKyn8tS/NwDQsZgYw0aaTVHIk
Q7XhFXJwnXpa1Y5NvOwgVJ3/rFjbbCJ80vZZMsqvT98bm/XMPHfwfra644uK/WKz
MzCDNDxTMB3aVmg/QvYeMJiJ2z24EhM0cB6V7JoNazQV8svDHRS4DuxhJ4kKTG0u
FYnr1KOxRBa37P5V8xQX
-----END CERTIFICATE-----`,
		"client_cert": `-----BEGIN CERTIFICATE-----
MIIDNDCCAhygAwIBAgIUWwsYs4IYFb55qU7EsgK4acOrzIIwDQYJKoZIhvcNAQEL
BQAwGDEWMBQGA1UEAxMNa2Fma2EtY2x1c3RlcjAeFw0xOTAxMDUwMjI3MTJaFw0x
OTAxMDUwMjQ0MjJaMA0xCzAJBgNVBAMTAmhpMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAwOA2j5pinWQPXtIrkHPRcCF1zU9/P7TqrIZn924R7vzir3Dg
JewSxIQTSIO5FX06qDb11bVONBAw574X1ERcZm5e6e/01BQopb6YXthJKAqZW8o0
X1jrpjvxGXYx9x5e3bGEbmX1UlHzkTOgoMO/RLOmLReTEA2CB2Kka5DkbEx+PnSi
i4o425Xjkvx0OBYeOtZJO9sXZaCRv+JtVYsHTUL3TstM9SF816xVJugYgcnTj8de
6N1BCI/munnHQmT+Oi41r10zm6fjjf383RRqiiY4z22G0Mw8iZd3nAHuHkQy3LL8
0ahmSeqcxha8Y2JcV8GZvpWjoCnKCA65uBJIXwIDAQABo4GAMH4wDgYDVR0PAQH/
BAQDAgOoMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQU
suG8rqEJPQCXA7YZMfu4bVQYpZMwHwYDVR0jBBgwFoAU7rTaYW7fbnLA6gPJwSLk
ukFrTvUwDQYDVR0RBAYwBIICaGkwDQYJKoZIhvcNAQELBQADggEBAASm4UIS8vL8
HWTxcB4fuYMpdSdvSKdbqyqOCqe7ExyCedQJO7cjo7PSq7J6X53Rt7jobtdpz/Mj
EPWjRXE5+GkGlhh4JJqqQp51XnA4agDrvEfcN4v0+lLLJIu9uYgsB4DgTeZPZQFj
TbMX327PfTXtWAhMd00kRozGLmIvBdpwHvHXrrWYHXANnk1TufvN8B4MxbtP+vCS
MAjr7QnTdAWzBrDMy7fzUv7QF1T+CSi3MvV3F6lNQMWyVhCzF6WcYRcY9oD0dVfe
+VUfWqxSr4lqh0RAXaVqQWDrPeUI6tkS+8GP/cIeZ+NpyWhSJZj2sMbGhkUjsfBu
qse4O3k8ibI=
-----END CERTIFICATE-----`,
		"client_private_key": `-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAwOA2j5pinWQPXtIrkHPRcCF1zU9/P7TqrIZn924R7vzir3Dg
JewSxIQTSIO5FX06qDb11bVONBAw574X1ERcZm5e6e/01BQopb6YXthJKAqZW8o0
X1jrpjvxGXYx9x5e3bGEbmX1UlHzkTOgoMO/RLOmLReTEA2CB2Kka5DkbEx+PnSi
i4o425Xjkvx0OBYeOtZJO9sXZaCRv+JtVYsHTUL3TstM9SF816xVJugYgcnTj8de
6N1BCI/munnHQmT+Oi41r10zm6fjjf383RRqiiY4z22G0Mw8iZd3nAHuHkQy3LL8
0ahmSeqcxha8Y2JcV8GZvpWjoCnKCA65uBJIXwIDAQABAoIBABXRBrrllqQA7nAm
S8EyKI2La1zG0jjtiOHs7hOhwquKtUVs+h2v/0t1OQ0pwSS6HolqdhIvSOJAtpdv
/BgJh34am+fQOZxHj3V4Apov0s6RrFkinRvv3e/WteXQZcRzDf37l2Q5ai9ej7Nr
6I5mtdrai0BsezkEniGhucFlCUFqj0BkaqcC4ewxGZd9AQMX689NOPXmUp/PwYLc
T00G41yIw5bg7uOexjlRV1qo6TBnIEdBKlfsTxlPYTckeWvMfrCfkPXOWKKoagfJ
gjygpA51fX3LuoQekREp6OAX4D5JW1yEfjVALA00NLaldxm7dSY+5PXy3Bpmc8Ma
AdSvWvkCgYEA6t2WkVNR3zeLSr241Alfhz6tAKjD4VBc3LSqAFlGBSxfwr5PpDmd
zhwPcAei9CpYfIVkSpySBDm6ch+gFVNFjrCxpQizA2BX+aUkHS0PdQTVyNwwIzSl
b+3r7dn+0bhQu5y/mQB5PxlpsmPVq6TYkE1zmTw7/zJaFJzgNkSYWl0CgYEA0jtX
LRu2DlHZkPk6WnSCNIVl4ajEqDaKxFIxnfFihXsezn6TkIokeld6wJXQ3xcYW2nJ
+EDgCyB0mq2CaIpAiW70p2VilZav7cU6XFmwU8uAt6rQhwMyrCfPPq5WHm4dZvRB
5R7521cI2A0oCXw/lnQvJ/PM4VZ7VjCEOqExWesCgYBKC+6KhtBLJcHeoI4DG6lo
hFQa3xpSkPmWA8eNMJgozWKrjUCisB+WebZMRbwUar1XFN8XvuEyP9kOXfYkgwpt
ADwhoep+aAOUi4IlSK2U4R9doj3y+4glD8fQR2hVSlz5qWOmo0WWpTZzrZIR+Xjl
leWaLClmPcO0t/jgYyP9aQKBgHU+PMbeTnC7+u7b30w076xkvMXVfh8lk8wa3qrr
xHsWh763XopcUC2efcnLg1n3IlFQtR9q5setyPm+TB0LBSTgKTb11r3/9ItQ09RO
/IQu2NEVRQgWo3rZFL4rMcH0vRb+n4Us+kD1z+vVon9vuHKqxuWsFJWSymPt2MBt
xv0TAoGBAMlIgU0RsA4OxNM3Yfq2xGknHHAK1grNp8BygmVuqBcaPdALM6viTEbZ
ZhFZ6M2ADtWgnEyoXys+8zfiVuGv/JMcJsAokAkOefs8vFhuZvuKHaaw0zk68D8v
7/6/QyQd3n1PF1gbqqIO1sn2WTvGpTYquaxzLDDutI4lL9xRBtoK
-----END RSA PRIVATE KEY-----`,
		"address": "localhost:9092",
	}
	producerCfg, err := producerFromConfig(config)

	if err != nil {
		t.Errorf("Config is valid, but got an error:\n%s", err)
	}

	if producerCfg.Net.TLS.Enable == false {
		t.Errorf("TLS Should be enabled")
	}
}
