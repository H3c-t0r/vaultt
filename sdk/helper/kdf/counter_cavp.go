package kdf

import (
	"crypto/sha256"
	"crypto/sha512"
	"hash"
)

type ctrLocation int

const (
	ctrBeforeFixed ctrLocation = iota + 1
	ctrAfterFixed
	ctrMiddleFixed
)

type counterCAVPTestCase struct {
	Hash       func() hash.Hash
	Counter    ctrLocation
	RLen       uint8
	Count      int
	L          int
	KI         string
	DataBefore string
	DataAfter  string
	KO         string
}

// Subset of tests from NIST CAVP for SP800-108 Counter Mode KDFs.
var counterModeTestCases = []counterCAVPTestCase{
	counterCAVPTestCase{
		sha256.New,
		ctrBeforeFixed,
		8,
		0,
		128,
		"3edc6b5b8f7aadbd713732b482b8f979286e1ea3b8f8f99c30c884cfe3349b83",
		"",
		"98e9988bb4cc8b34d7922e1c68ad692ba2a1d9ae15149571675f17a77ad49e80c8d2a85e831a26445b1f0ff44d7084a17206b4896c8112daad18605a",
		"6c037652990674a07844732d0ad985f9",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrBeforeFixed,
		16,
		0,
		128,
		"743434c930fe923c350ec202bef28b768cd6062cf233324e21a86c31f9406583",
		"",
		"9bdb8a454bd55ab30ced3fd420fde6d946252c875bfe986ed34927c7f7f0b106dab9cc85b4c702804965eb24c37ad883a8f695587a7b6094d3335bbc",
		"19c8a56db1d2a9afb793dc96fbde4c31",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrBeforeFixed,
		24,
		0,
		128,
		"388e93e0273e62f086f52f6f5369d9e4626d143dce3b6afc7caf2c6e7344276b",
		"",
		"697bb34b3fbe6853864cac3e1bc6c8c44a4335565479403d949fcbb5e2c1795f9a3849df743389d1a99fe75ef566e6227c591104122a6477dd8e8c8e",
		"d697442b3dd51f96cae949586357b9a6",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrBeforeFixed,
		32,
		0,
		128,
		"dd1d91b7d90b2bd3138533ce92b272fbf8a369316aefe242e659cc0ae238afe0",
		"",
		"01322b96b30acd197979444e468e1c5c6859bf1b1cf951b7e725303e237e46b864a145fab25e517b08f8683d0315bb2911d80a0e8aba17f3b413faac",
		"10621342bfb0fd40046c0e29f2cfdbf0",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		8,
		0,
		128,
		"08d0a37d2e2fb84d44838efaeac28135d964b0daf154369783cfe007fa883966",
		"80866d761e34084b45ea668a25deabffdbca446aa0bf793bccdf3790d584d26056315a4c060ac7b1b01cace96ba97e8fed81953c8b82ba5132dd1713",
		"",
		"8f5b47d23d5d3ba632acdf6543509bd8",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		16,
		0,
		128,
		"3b11d0b6f1b49d1a41eecc7448766bbfee47d32a28a3f2be3d3b5f21c4d1e6c6",
		"a6aca3725e8687268cd9cefcc4f3799090568e777a18e82569922463658c4e8fce319316edc172eae3c7e4f4224ffe7d72730ec2f8472f80122a5cc0",
		"",
		"fffbde92bad6dbfc61953b78c47f7b93",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		24,
		0,
		128,
		"585245d11e0b69d10e2ea39c76c8625003aa775037e476009856ac8e3e9f9b48",
		"1b8234e4a0c9f674fd6f29965bd03df4a8d30b17cf95b058ac46bc2fe9d8ec79a004a2e11165ae3131b9b9440abf9a6fded0d31af468aa56fee00158",
		"",
		"73781a39ab0f3cdae0d8ea9649ecbe9b",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		32,
		0,
		128,
		"ec8674a48a7baf28f865e63a3e8313fd55a09c8a46fb491916a871d1e65ab7f4",
		"808772849ce4e97060618f8e510419a82d78a72ff265aa247335069fc73eca8df5276c850b5f052f0551da5319bb9e39318a820b167c6f999c67d4ae",
		"",
		"9417ee14f9ebeb2e2c7bce18aa56a1a5",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrMiddleFixed,
		8,
		0,
		128,
		"6fd0f7b67db5b9ef0fd21d4408dae15af5524b00e8d583e9872760ebf6d53397",
		"fc67e8cd41dcb339fe376892b3c196ad4d70573e031cebac67bb32a00a878d0064446a98fcce9ccaa6d8d388e3cbdfb8dcc6",
		"e9798604020da472f161",
		"b24833fe4a28f84fb4341bc42abc4ae6",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrMiddleFixed,
		16,
		0,
		128,
		"e4f6a0b7bc8941f115f9523a050f527687213a4236bb8047d9ec6671be35278c",
		"883c38f759847b142a05ba28152a391b826468fda0a269d55248d1c3daf2e66fe91c20b85c57f6b5464903bc93500e5bee04",
		"9c52c875593e59580155",
		"c9f14ec1dbc676ac650ffcd143bf5c5c",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrMiddleFixed,
		24,
		0,
		128,
		"367fc005cb2565a92cf8b1cfdf4869ccad04c9fdfc8250d027d82a33cd0b36e0",
		"f3a71b1465972703773ec0c92681bc27e626587fe683a07fed69c9bb0a1053afa1ec187cf26fa9dd8c690f415af98d442470",
		"b9dc98f750c71d74e243",
		"67301e0b417c5af335caee31b3e620c3",
	},
	counterCAVPTestCase{
		sha256.New,
		ctrMiddleFixed,
		32,
		0,
		128,
		"60e118235b5fca0b15f8dbe6109b6a1a2f9d0d6f69cecfb5f65d4eb5a1c00a36",
		"3c04bf77b146ef5842daafe19edb9530b7d19b3519aa5c7e797ca5cea0d82ddea484d87d735e3541cf0ba1505cf5c45d8067",
		"9803f3f48ea0a23e2856",
		"d296bb7b1707c9109d19abf026c141f8",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrBeforeFixed,
		8,
		0,
		128,
		"6ea2c385bb3e7bbafc2225cee1d3ee103ce300c1fdf033d0c1e99c57e6a596e037020838e857c0434040b58a5ca5410be672b888ef9955bdd54eb6a67416ff6a",
		"",
		"be119901ed8679b243508b97663f35da322774d7d2012d6557da6657c1176a115ebc73b0f1bfa1dba6b8c3b124f0a47cff2998b230c955b0ea809784",
		"e0755fa6f116ef7a8e8361f47fd57511",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrBeforeFixed,
		16,
		0,
		128,
		"bb0c55c7201ceb2e1369a6c49e2cdc1ae5e4cd1d64638105072c3a9172b2fa6a127c4d6d55132585fb2644b5ae3cf9d347875e0d0bf80945eaabef3b4319605e",
		"",
		"89bf925033f00635c100e2c88a98ad9f08cd6a002b934617d4ebfffc0fe9bca1d19bd942da3704da127c7493cc62c67f507c415e4cb67d7d0be70005",
		"05efd62522beb9bfff6492ecd24501a7",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrBeforeFixed,
		24,
		0,
		128,
		"d10933b0683f6787c33eccea1c311b8444270504fb3980bfd56443ba4068722184c31541d9174f71068b7789440bc34cec456e115067f9c65a5f2883c6868204",
		"",
		"dcb2ea8d715821d6393bd49a3e35f69a6c2519edb614f80fbc3f7ae1d65ff4a04c499e75d08819a09092ddaadba510e03cb2ac898804590dbd61fb7e",
		"876d73040d03d569e2fcae33b241d98e",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrBeforeFixed,
		32,
		0,
		128,
		"dd5dbd45593ee2ac139748e7645b450f223d2ff297b73fd71cbcebe71d41653c950b88500de5322d99ef18dfdd30428294c4b3094f4c954334e593bd982ec614",
		"",
		"b50b0c963c6b3034b8cf19cd3f5c4ebe4f4985af0c03e575db62e6fdf1ecfe4f28b95d7ce16df85843246e1557ce95bb26cc9a21974bbd2eb69e8355",
		"e5993bf9bd2aa1c45746042e12598155",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		8,
		0,
		128,
		"ab052ef2e9137415060435b9a73a67623e07f3467981fe8093c440973658851028c86e44a1fd9100b413792f14e257683aa74b83ecd96d24c862c2263a496cfb",
		"668831e2701803581eb9083a0928cc00d83a3c19ca4df061d155a880a66ba24857ad6f4bd7a67382215b5b9d81b37737d74f7a5ef78486aeea2f9ac1",
		"",
		"6ec2b089107021463bae15f8f5c771ab",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		16,
		0,
		128,
		"8c38d9f55e75b83b92ca7cda2df3e384a47445620aaa5b74ec74399a2ad5d3ba2b65970916e49bd0b01ec03563c3652962a3438a1c06bfbf6c6bd7586b41841a",
		"45668072071d4f12af25cb2140a7e2f09ef62942bceb5ba9b87c57e233b3656a572ae38a1466566a8be649c79f479c255cb8d3821c02c75cb5171884",
		"",
		"06332aacfe5942eaa931902d83f692ad",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		24,
		0,
		128,
		"63bd6f4163b34ece4477605db93e6eb7f4a8c0707471b081d8bdfce44e5823b62d346fa60a3d338c675eba7e5c0920f50197872af24a124d3bb20c45d30dbd99",
		"699bc682c47f969db1d62ffd906711d34ebdb9fccd597e6f5ecc7d7258b8574947307cafa369ece5a4da3cc6d1fcc669f51db24a10112cc5cd9070dc",
		"",
		"6cedc5f5cf879f9f758f0de04f2ce145",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		32,
		0,
		128,
		"e482268362f80ca7f777b4202d03234a5f0ed59b578a6b8792ff54d900af6940beacc7d3fb801661f64392e5658d4f82e3b5d63b190a44c032b6a8ac51a2acc2",
		"9ce99ad9a90f45785e749a66df7489c4200904141391274dfb24a5e4ea8cafc87f920b33fcbac0d93fc59d4bf558b7f2a9e1435cb454a4f180300e17",
		"",
		"cc99953cc0d7b0da795293675442528d",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrMiddleFixed,
		8,
		0,
		128,
		"7b7ed39b91cdbc0c0b3cfed4830a1c5b47971c80054d3c82b75a98e98ac06adf86307afdeb15a7d83d896cc8dc0c0f8d7eb450ba31f4c12ec6fb131778cc2dc0",
		"e4e853508f5b07a1c8e7033d0d683affdac3b7cd5931c53933b49bd30ec149300735cfc34a307dcb609a26c9378e8f75bc5f",
		"689823dbc6bf6d3c097b",
		"d0ad633ce6ad0d4ed5ab9247177de926",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrMiddleFixed,
		16,
		0,
		128,
		"3ee8a94d1a45078967a76f1094923fb0f67691bf54159d100a0c2c9dc12cac84c394a9a1efb05df78e0f03342b9129b2bf06d1e4f6bd25965fcdf2ecc74f4a2c",
		"5527ea9f8ffa12569dc4c1e95a92b213072b50db9dae2a53d8a0d63640749057f3c936377400d69387df468e1a54cf19530c",
		"e72f4c2b03d7ed637ad5",
		"e3090abfc11f8b709207105d4ed46505",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrMiddleFixed,
		24,
		0,
		128,
		"5572ceb20ce4cb93b4a3781e55846f4d012fe5598924beb134a17dedf2b59da3bc997d5a105b423cf49849c33bbcef564a993c8a648b4d8fb567f4c08030f9b9",
		"bca2eda0ac96d53e7f94f41ef880cd2dcfccd2bd0c116a87c7e6485fe7535469da538c92f6d6c8443f480d10ebfca36e441d",
		"4072f6e842886be123d3",
		"abc01ab53b61ce1cebf3038b42a4a854",
	},
	counterCAVPTestCase{
		sha512.New,
		ctrMiddleFixed,
		32,
		0,
		128,
		"4cfbc55d3a2334c71787ea1c4b9426106b1ba327a909d54fc9b3113f4b74617fec68858a05ea9943fffb0623af633f2a16ae87afa37e3f304da41f7b83e4cb91",
		"2d6b4804ed912a9bf3005db33c221c6793ff33ffc90bf559811d63fdd0d06f8f36da610f2d555ea37bf3f1220a8e8a8a8629",
		"adbd9e4688b45575d385",
		"5260b2e61f6ad15e775a793c699c5583",
	},
}
