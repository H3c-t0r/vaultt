package kdf

import (
	"crypto/sha256"
	"crypto/sha512"
	"hash"
)

type feedbackCAVPTestCase struct {
	Hash      func() hash.Hash
	Counter   ctrLocation
	RLen      uint8
	Count     int
	L         int
	KI        string
	IV        string
	FixedData string
	KO        string
}

var feedbackModeTestCases = []feedbackCAVPTestCase{
	feedbackCAVPTestCase{
		sha256.New,
		ctrBeforeIter,
		8,
		0,
		512,
		"664437e754a18261523a86f720584bf184559688349f44fd0d7f8c3275dc12be",
		"c290feafc620f2800bc1432d6606f9643249d2f44494774187c2b3ea13eed858",
		"180c42aac329bf148e4e80b781462f583ee0e22299a897b66fd177bf7fe67a662806af75f4cb3bdead5d3824ed1d370df734da",
		"02530795804f179c9140b4d02b66933cd65c159ede2a84089f34c83cbbfb50c088053fb8e51678c8217f3b3598514da0695ae988c4024b961661f5fa7a5fe464",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrBeforeIter,
		16,
		0,
		512,
		"eee4026814007f2418bb6d19927fe00711c4ebc479c6df0033879ff0a5a790f1",
		"a756df44262d443214da7753f8924ddc44de436322c207299e1a44f591c77b07",
		"0241e41fe43ab31cff181cd4aa5152fcfd5d7f05e5b6f1909c6c8f3f859ab8bb2dd4858dc44bf2762aa60c85ea5365cdc8aa98",
		"61fa3d570401bcbea9289a441696d2c6ea2dc17e94d33ee315174e4a1a084a8f234a4714889b8ec56d013b6a5ef3c97fdb3d19523d9b1b3f6532c781841224fe",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrBeforeIter,
		24,
		0,
		512,
		"8ed07693b7d4c60065be1cec1d4092118b6681fa5bf1e540f97aee5368c32e6a",
		"d1ac3b650a4a9fc507c4de84a8133bd94c407859fee51599f81929308c159619",
		"0d70b440a77b12ba9d6f02187f1b5bf42381ec83e1b58cf18aab0b567018d465ef56842a826ff9d42f2459f7d004e310dd39a9",
		"c6978a467a7e66e3486e3dd17e293ad2bc41379499373b1cc8ff237217754df5d313f1cd853918564dbdb2b71a518aca1c258a7c69d57bdcd7688fcdfdb6962c",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrBeforeIter,
		32,
		0,
		512,
		"c30f82d6ce7d2e1909355b0e439b4a280bba1d745e57fa7f84e690333d708c7a",
		"6283ffae19781ce38285c4deaa9bacaae1ce6aaf09eee3b4e33b6cf964ae4f6c",
		"f05c06efe9b2fc6b7e2df7a10dc15255c1b2b448b823c1fe5a088e17457a092d30b6eb100969e1c625e76543bf30d9927df700",
		"60cbb4bd3fe1d7f459837270b67703a456842a047281e22044416cfb220c5f6ceaf326ef46591a06a65c739ca3500484e7f19c1c727013f56ed9f57aae0e4ec3",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterIter,
		8,
		0,
		512,
		"08f1d928d466e9a709832c93ea5f32384f3517e06a9c639c1ad543b2b23841c3",
		"836c1a8933e60dcde0031c8fac9141db0b56f638851815320cfd87d1fcf7a636",
		"7f34e1f4cc56773f6c1016717393d47a7c271dd1024335d913b804817254a59da3ee1fc66f26de9753c9fa9d83b3413dd963d5",
		"ea643447585d9cc52ad64b7034fad8c032ac187d83c30c0f6d7523f3eca1f184202ae2fa304d2e6f16d73036db084799ddffabb59d22bfe59b962432e5d1ef23",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterIter,
		16,
		0,
		512,
		"16e7096ddf96b0d861f31e7a6b33754b045c5e7107ea6ce0698f91c69c8e4dce",
		"eb4412d0665ab13b74c1ad09d5e3de0031380e56430459c543917f580d3d8b7b",
		"e32e45c140888b8b64c84da9852461d29c11b2ee34da2aae635821da94914f3f3f2efd81ebc9434840a174c32cef2a87d56746",
		"33175406d25ae0a7647268f548dc948c21d4215362e11a66779144a88f44ddc074e2df853152d87c55c79e47beb851fa216bd2fa04da425a1d7bcd2edde706c2",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterIter,
		24,
		0,
		512,
		"59d0fecdf3dec65a2ff4f2ba848b27f1f9b72f012a5404ff79fd722ee3d1b282",
		"16100f9763a1621f81b21693ac77595191539e168606c7637c19eaab25d4a310",
		"9663d24c6815c4c1063f22b03acbfe5fde32f4c9d0c4a6917f69a0b73ff987febe260d8f56674c883adb446e534c5164175387",
		"0976becd311a8ac8aa8eb6f4d775cd7f1c0ec766d9d3cf084b1e788fab2f402d00a1f463c5bf60536b6a0a0c098552270e561f67c3dd2e73a2664ce5ff8f55ec",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterIter,
		32,
		0,
		512,
		"94d74ec6747861a3b06fbf8db8bcce620bdca7f1edaa5155d34b58eb29df55d9",
		"694746501393b2fdd1220eb4e53a41961f760edb43a4216d6a2a7c0306ba162b",
		"e67c92a5816746464d8f12e32167664de4f183d6c5a867707103db44b697ff50434d21864c4fd1df7fe99629be0894eaa44ca6",
		"1475bf8c0b29c217207165c6618b99e59af773706e9afb11a1b46bbb7bc98b26bfaa24d39d168a6c5ae5e58d25e9817785ffdd1e419bcbc9ed043ef42223c4b6",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		8,
		0,
		512,
		"34246365ce31a2984bdb7e9063c81b60a898a0c5ce97b0597a85fadea37c4de8",
		"581514ef69dbb8af6bae41b843bd0efd00fce694a80e264341a3feac5e86f736",
		"f533c4f89e0fbd67b54b3059712aefa399d365c0043eff606f64883530bd18b2199315d58d4fc2b99ebc5f9055938fc5039dfd",
		"30123d6b0227e0f594477c102e963975ea586e85bd54acb614a2544ff2e83bd3066b20880768282346ff0a7c0f8ce9f6e433f032ff0c6fa9a9e920adf81c9d17",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		16,
		0,
		512,
		"5905c57e0f65a243b3967245f9b811c15257cb9a993cde26d86c71c8f24bab2c",
		"6c7cad9d96bd200160604119659092c8a915e61ee22c18cb375d8936c0a900b0",
		"89d2ba32f3ba155a5c8675f47ff32d05cf20934c424508136f69f0356a81aa8d92919ea67daa724a116887ed1d0b9ff3fe3403",
		"f899ecc0fb66b5208e747ebd75b42c3bb704cffa6785e961b2a1d3a66cd7678e4b1ad291eacd6148105e6aaedea831f3d8f566ad0887c165bf559f1146f050d0",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		24,
		0,
		512,
		"df99db5dbd23caab696c2d26a43641e2de62eb8dfac84b7b0e395827d450d4ee",
		"82512d329c16b703ffdfa84cba35dc846ffe5e7f79dff5f6a215721510360939",
		"3d0b221f534d7458f1b6f05b98db30cd0776c496b4a632313af5915a5d7f15d84cc98d31c896e801acf07efd04680645e09118",
		"7fef9ca52722eb7304d45854ddc13d170d7dd8f452277f4497cac005c145bc8241c20d7100bb0f03c314d3c0be37f9f99e634888e486855be070fd6283cdc0c1",
	},
	feedbackCAVPTestCase{
		sha256.New,
		ctrAfterFixed,
		32,
		0,
		512,
		"9eaf7a9b5fc22f9a555bffdba314deb3766840c8732911f02a87f67e291bc0c0",
		"4755175a0c125148cf340975aa2a7441e9c57cd56288c827e68fe413edd49827",
		"931f6264849283e3e645625ab73ec0698b1e8305f38bf3894a79e0570b89bc247ebe061caf98ec63b2cdc67059c16852b2c255",
		"4b1fd9968243bddf4b215ca3623f09ce9d63cd46cfc55dbc29fb2504e17ae2bd68ae786c55ff1a43d3bbb2d6ffbd883db3588aa010a5f1ec56bc8b207863f24d",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrBeforeIter,
		8,
		0,
		512,
		"ee60b5d94c7b0dded151589f3a6eaa70b7dea889909d95569d77a2c4a72888bece2226453e5f776b9b107d9c6c71c7c61830350ab92f6812cc378ec7783d4bc1",
		"3092013eb1e7908dd9e84408d85c6ea2c9ec9ef8561236d28ce050bee549da0c74a3d128515b18f3abc475b77df4b27a9aa43d54a0caba46e3459afa668c54b3",
		"8ecb14c70d18794f4f467d935852c69eb24a1d743dd76513e99ff28cff63091a1027ca956ae1ea8036aefb33342b4df59595fc",
		"1695a59b66bb02e11eb64cfd3cd4bdf1e3d4af9482edcc4e841f60378f2a9ba76220b79a07ef172da0f159f08b2a71a7a86e59312cb96abc1ca9e56e7e6f735b",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrBeforeIter,
		16,
		0,
		512,
		"6aaa78ef6048ceb9a192e904b37f1407c955725a7a701fd3d2423950881f373935ff0932d1058c090bb29e4f9436b5855b58b3194c1a8fb9c9889d594dedb205",
		"88bb774e28fd56b3030a3a3f10f0fe75f5f27cffff110bb0214c14f134c862c731c0813fafff7df63fdf507aff5c0c4a390d5989fe4274b0a405a5f317e3bc7b",
		"8d103fb5f69d1ad5edfcb3d0266748137be582a3fcb5fe1d7b62938954ec377d266e3477144ea22aeec0933222fc2d2f745517",
		"ee2a1a1c1d1586fb9eb53c37d915802382c207707362509da54bdb5fc8d89bd2a6671703310aa5036689567fd8d7e85ece30ecdbe9c0d1000a12b67499d8ea1e",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrBeforeIter,
		24,
		0,
		512,
		"32491d4d0979d339c62a5c458d146236aa68de2edc4bd7d8f0061b6d3d628854dd1ed27d8b97d258e51be7e75697b2d73b6e5dbe52843055606f30fbbb92ea79",
		"4b5db00fc306e3c204f53bd3a41ed45e616292f8a0c363eda76d79ad6bae6a6556b525ffb34c086f8deccf9740e13fe54838fe2db0194f6634a52c0ea9f4958a",
		"339b7479168e15bab7da157a31c32dbfbc94ea3c10aa4503dd4425d75526914caa0c06a93b805c8acf81055534551c2c793b18",
		"306ee48f3c56165fd9fab7dae50248fef2845a6e9981bcaa8e06a1651c894a8e50a62a51aa6c4dcde11d86a2c1540564a994905075e29005a38d7a8b6cdec7d4",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrBeforeIter,
		32,
		0,
		512,
		"94b688ae021be0b20a38fc347692cd9237831c71ad3a7313b3e06866a1b15232e9e7ba13f2c8594ee2b83b8fe937c0b09a4a131ddb496d0696d50c9688fb3065",
		"c9a9a00981eaf9060719989a16a857dcc9c2ef577a6320589dbd0c8897ebf33452486030482125f9b7b8c5c936c1fc7f24f3ed714f7a759cd035a8599ec3ccf9",
		"7e900a81717472fd8dea6fb63604baf51fc463f7980f3643a9c47cad2128ed0c27c46efb33f96014b3f8c62e6f2ef0bad055d5",
		"4f6d2880328123420a451253737a3881c4689d3f2f2cf98ca64313e162ab9a4dea7567f832acf88b92083f33e7d637788653389f18817090f094bc0461df985f",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterIter,
		8,
		0,
		512,
		"8a142a8c4450f028bf54dc4878c1d37e159942346d841c663072b960fa676b4bd500aa34e9b178e8a33b755f7b6e005eb2becc6fabd40f40ce6edc14765eca62",
		"812fec600d466a40435548576f2ce85a27d6c3587b7c7d0a0d0b5649e2636344e4e5af4e4512e096409c68711a880547f3158b16ed49c0f6186494e76111371a",
		"776ab69c4ceef722a3ab1d6d7f4411b21bc04f02ebd491fffded713c4fdff9508db9a5b69a26d3bbb1f110fbcf031753b7940a",
		"84040b1698c1673385bc62eec00efb5459726f72ed733201ae7426a7b3cb2737551d03b399773a7f17ba3797787dafd23a9674adc36e5df84ef49df53dc0d6d0",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterIter,
		16,
		0,
		512,
		"0ac5f301ad8c7e576e174a42ed4c9a106af9e72858244bd771e9453a85c8a6a430a2a072e1a17622b1ce89ac2f30a1ff9c71da55061aef4c36f17bc6c44cb41f",
		"f4fe80a0cdd78d87a4476145feca274bcfda9a7e6dfaa3b48b9884e70638a9335a7dfdc4c057b2110d5887a5fe7bca4da102763a17697cc04d2cacc968726e66",
		"f0d0904ad9ad972a9dab8bd89497b749a321619b898484482cffaa6d31fb032eb4138f3b5ff61812ee886a3c03547a082d7882",
		"94643c37f643c030e8a0f1dcad77e8421b8a9d17d0090cc1d1e59d7901834a6e6eeaeaf03b59d9c5a5023034c80ff492d08b11da854a2f3c453f0f21107cc82c",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterIter,
		24,
		0,
		512,
		"a218c53a13929899a6aa1945a01feda9c338130d2d0afe07b815d9328341eca7e8903abac44c205a7988b1a93dfa56e25890a827e8c525c07e0dad19313ebc69",
		"861574359db20c8d7e4d0c7d821957dda42248d332bc1674ea883ca42e6e08d19b670d30903bd4af0e7d72e404ed9e9b1911253ce02d26cd318c407f11d89663",
		"f42b99b32d1994a9e10e794a7e39a9fd4f8d4be59125f18d7ab05665b65ea9459f91c1c9402b0abfdf66386563495316b74cf0",
		"951feb91885f97ac7815e9ee7a05f1e74068cdce84d49aeb55c573228ab21ab0d969fdeb345c8a661236c5fc3fc623256a1174882481f44d4dc5e4cf083a89cd",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterIter,
		32,
		0,
		512,
		"9734ab96caf0ed1cde5a77b9dfc59a5ff4f562a395a6fc9c1fe6856391a76847d2616e5661a5c1be73cb405c6c48f8c375317d9e544dbbae72bc350833a3a72e",
		"f7dd14aab37c61009fc00aee7ef98819fc54dfff2dd3811b0d484fe615b0ea6955751da3314d0e6d0244866b024c0d1057c44721fb12c1aa602a78184357fa2c",
		"928d639a82098f4e4e34aafa23a47cbbf21b8b96aaa8c1b7dc588e975faf63bbf3af61ae373a0965a90c51846c94748a21ec1c",
		"69a9127c911c6edcae338336992f4e688b037a2c4e7168f274f93be101240273fc9905b33e0e70c265418c0f61d30175f05d29b50da19bb248f0962d55ea54a1",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		8,
		0,
		512,
		"6087967c09df5099059eddc44e73b2939314ec7bf4c4cfc55ccd9d3ba12ece87c31067531588329307f877224f3b5e7458a4d3eb67c136de7576bbe6f2fe2c20",
		"ad0a2c68d2c426bd4480c49d59c504e49c5893756954bdf5950c6cd33add3baccd547940ea97db759c55eae2cee004dfcf37ff1938853146aaa6f0f010e3f997",
		"59cb8bb21e2f8a5813c1dc6836d78b4276db20e8794dffee4232f5be7738be656eb228af33eb26d7c1f7d53ca5556768c8c1b2",
		"3f4ee8000796c85137f0076b2d86be783850049ae51a3bd18665f13f141a7e4ec49b6d97e18df5a2a2acdd0ea475b6f2419209a4b5c36ad13881c08f50e99442",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		16,
		0,
		512,
		"17fe89503ba32e6752863fec6936e9f6d6d3bfbd044639b07091aa2c79ca771a50e54265dc34257acf0c9158c7e8fa1504ab87e2a1c7484e81d463794598f414",
		"9481279a4ad508406e244b86fdda04dc436533ba1df5998c6314972cb1907993343bdee11be95f222c30769b5fac40349438f0441bb018ff67d94b01b8c60205",
		"194fb9131b61462474715ed13fd9bd2a645802bb0520b47125b07ffe88a9a1f0b331f29a181b19605965492a621c1157bc64b3",
		"5847495cf20b64c3a681bd7c62bab10e05c208290632129e7b7c1f0b66a6b16a0ca271e628d55a67f0d151aebcd88a6d17d30319aa1dc91903942d8ac5c7fcdc",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		24,
		0,
		512,
		"2f34e1a5cabf345239f0b4668c0a1cc2aa36ec17a30959cbcd8da3a613d3c4c391db72745d73523d707ceeedc5b9f1ada44e454a5cd4e6ecece3264ad5bad936",
		"fa4925f1daa772655f5fdccff0a02e20ac44f0b22067fc110c20876d57116722b58e228507bceab1c395bcca40edd6444c5c6064a90dad49d3a4a7b3b4eefcc2",
		"2f6c07c079e2352c12c89f120bdd8f22551466b5cd864a54d6148fc78a2f695997c0a54c176e34b9fbfa5c043a9fd941cc87aa",
		"4f0fc2d70d950c5c8f8f2d0e5b1feb8e8266d56b26eeb2214edd4ba499a5830fe5a01e95adce608aad5ef7f35e0c02fe6805566a2ebb5a80ee38710aacb34f06",
	},
	feedbackCAVPTestCase{
		sha512.New,
		ctrAfterFixed,
		32,
		0,
		512,
		"93de9fe90faa6e5e909c57f96b9c85f1c8dca7ceaa4ea8b37cd4e0258259f28085cf7db5edd054dd882459b11b5ebf9c3b221f8d7fbf660ce66945217714f88f",
		"c7cf0fd312a238658de22bcd3f2823191a905044f420bb04d9f25a0fa2f019979fcb8df94607419bc300528d77bceb3a4c6774043ce4e07ca305773208cdf331",
		"3f1a6480f05b9a767c6bb16db87e39c6f320c954b4f5c3e016faac9fe1acb5b5ff9e3f25fda1bf1b31b797f7c4a09137a19a24",
		"e23d7dfeb0620ce845169dc294b94122fe450a03134548ba05c8dc1658609014402c140a29f9bc108c8ec1393a02b104e03e51fffb3110cde420459a792e065f",
	},
}
