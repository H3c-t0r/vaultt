<PageHeader as |p|>
  <p.levelLeft>
    <h1 data-test-title class="title is-3">
      Reset password
    </h1>
  </p.levelLeft>
</PageHeader>

{{#if this.successful}}
  <div class="box is-sideless is-fullwidth is-marginless">
    <Hds::Alert @type="inline" @color="success" as |A|>
      <A.Title>Password set successfully</A.Title>
      <A.Button @text="Reset form" @color="secondary" {{on "click" this.reset}} />
    </Hds::Alert>
  </div>
{{else}}
  <form {{on "submit" (perform this.updatePassword) on="submit"}}>
    <div class="box is-sideless is-fullwidth is-marginless">
      <Hds::Alert @type="inline" class="has-bottom-margin-m" as |A|>
        <A.Title>Current user</A.Title>
        <A.Description>You are updating the password for
          <strong>{{@username}}</strong>
          on the
          <strong>{{@backend}}</strong>
          auth mount.</A.Description>
      </Hds::Alert>
      <FormFieldLabel for="reset-password" @label="New password" />
      <MaskedInput
        id="reset-password"
        @name="reset-password"
        @value={{this.newPassword}}
        @onChange={{fn (mut this.newPassword)}}
      />
    </div>
    {{#if this.error}}
      <Hds::Alert @type="inline" @color="critical" as |A|>
        <A.Title>An error occurred</A.Title>
        <A.Description>{{this.error}}</A.Description>
      </Hds::Alert>
    {{/if}}
    <div class="field is-grouped-split box is-fullwidth is-bottomless">
      <div class="control">
        <button
          type="submit"
          data-test-save-config="true"
          class="button is-primary {{if this.updatePassword.isRunning 'loading'}}"
          disabled={{or this.updatePassword.isRunning (eq this.newPassword "")}}
        >
          Save
        </button>
      </div>
    </div>
  </form>
{{/if}}