{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: BUSL-1.1
~}}

{{#if (and this.state this.version.isEnterprise)}}
  <div class="has-padding-s link-status {{if (eq this.state 'connected') 'connected' 'warning'}}">
    <Icon @name="info" />
    <p data-test-link-status>
      {{#if (eq this.state "connected")}}
        This self-managed Vault is linked to
        <ExternalLink @href="https://portal.cloud.hashicorp.com/sign-in">
          HCP.
        </ExternalLink>
      {{else}}
        There was an error connecting to HCP. Click
        <Hds::Button @text="here" class="hds-text-button" {{on "click" (fn (mut this.showModal))}} />
        for more information.
      {{/if}}
    </p>
  </div>
{{/if}}

{{#if this.showModal}}
  <Hds::Modal id="hcp-link-error-modal" @onClose={{fn (mut this.showModal) false}} as |M|>
    <M.Header @icon="info">
      HCP Link error
    </M.Header>
    <M.Body>
      <div>
        <p class="has-text-weight-bold">Timestamp</p>
        <p data-test-link-status-timestamp>
          {{or this.timestamp "Not available"}}
        </p>
      </div>
      <div class="has-top-bottom-margin">
        <p class="has-text-weight-bold">Error</p>
        {{#if this.error}}
          <code class="tag has-text-danger" data-test-link-status-error>
            {{this.error}}
          </code>
        {{else}}
          <p data-test-link-status-error>
            Not available
          </p>
        {{/if}}
      </div>
      <div>
        <p class="has-text-weight-bold">Additional information</p>
        <p>Check the logs for more information</p>
      </div>
    </M.Body>
    <M.Footer as |F|>
      <Hds::Button type="button" @text="Close" {{on "click" F.close}} data-test-link-status-close />
    </M.Footer>
  </Hds::Modal>
{{/if}}