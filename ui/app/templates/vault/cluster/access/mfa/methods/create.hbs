<PageHeader as |p|>
  <p.levelLeft class="has-border-bottom-light">
    <h1 class="title is-3">
      {{#if this.method}}
        Configure
        {{this.method.name}}
        MFA
      {{else}}
        Multi-factor authentication
      {{/if}}
    </h1>
  </p.levelLeft>
</PageHeader>

<div class="has-border-top-light">
  {{#if this.method}}
    {{! display forms }}
  {{else}}
    <p class="has-top-margin-l">
      Multi-factor authentication (MFA) allows you to set up another layer of security on top of existing authentication
      methods. Vault has four available methods.
      <a href="https://www.vaultproject.io/api-docs/secret/identity/mfa" target="_blank" rel="noopener noreferrer">Learn
        more.</a>
    </p>
    <div class="is-flex-row has-top-margin-xl">
      {{#each this.methodNames as |methodName|}}
        <RadioCard
          @value={{lowercase methodName}}
          @groupValue={{this.selectedType}}
          @onChange={{fn (mut this.selectedType)}}
        >
          <div class="radio-card-row is-flex-v-centered">
            <div>
              <Icon
                @name={{if (eq methodName "Okta") "okta-color" (lowercase methodName)}}
                @size="24"
                class={{if (eq methodName "TOTP") "has-text-grey"}}
              />
              <p class="has-text-semibold has-text-align-center {{if (eq methodName 'Okta') 'has-top-margin-xs'}}">
                {{methodName}}
              </p>
            </div>
          </div>
        </RadioCard>
      {{/each}}
    </div>
    {{#if this.selectedType}}
      <p class="has-top-margin-l">
        {{#if (eq this.selectedType "totp")}}
          Once set up, TOTP requires a passcode to be presented alongside a Vault token when invoking an API request. The
          passcode will be validated against the TOTP key present in the identity of the caller in Vault.
        {{else}}
          Once set up, the
          {{this.formattedSelectedType}}
          MFA method will require a push confirmation on mobile before login.
        {{/if}}
        <a
          href={{concat "https://www.vaultproject.io/api-docs/secret/identity/mfa/" this.selectedType}}
          target="_blank"
          rel="noopener noreferrer"
        >Learn more.</a>
      </p>
      {{! in a future release cards may be displayed to choose from either template or custom config for TOTP }}
      {{! if template is selected a user could choose a predefined config for common authenticators and the values would be populated on the model }}
      <div class="has-top-margin-l has-border-top-light">
        <button class="button is-primary has-top-margin-l" type="button" {{on "click" this.createMethod}}>
          Next
        </button>
      </div>
    {{/if}}
  {{/if}}
</div>