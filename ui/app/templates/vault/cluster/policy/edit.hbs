{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: BUSL-1.1
~}}

<Hds::PageHeader as |PH|>
  <PH.Title>
    {{this.model.id}}
  </PH.Title>
  {{#if this.model.enforcementLevel}}
    <PH.Badges>
      <Hds::Badge @text="Enforcement level: {{this.model.enforcementLevel}}" @color="highlight" />
    </PH.Badges>
  {{/if}}
  <PH.Breadcrumb>
    <Hds::Breadcrumb>
      <Hds::Breadcrumb::Item
        @text="{{uppercase this.policyType}} policies"
        @icon="dashboard"
        @route="vault.cluster.policies"
        @model={{this.policyType}}
        data-test-policy-list-link
      />
      <Hds::Breadcrumb::Item
        @text={{this.model.id}}
        @route="vault.cluster.policy.show"
        @model={{this.model.id}}
        @icon="file-text"
      />
      <Hds::Breadcrumb::Item @text="Edit" @icon="server-cluster" />
    </Hds::Breadcrumb>
  </PH.Breadcrumb>
  {{#if (and (not-eq this.model.id "root") (or this.capabilities.canUpdate this.capabilities.canDelete))}}
    <PH.Actions>
      <ConfirmAction
        @buttonText="Delete policy"
        @buttonColor="critical"
        @confirmMessage="Deleting this policy may affect access to Vault data."
        @onConfirmAction={{this.deletePolicy}}
      />
      <Hds::Button
        @text="Back to policy"
        @route="vault.cluster.policy.show"
        @color="secondary"
        @model={{this.model.id}}
        data-test-policy-edit-toggle
      />
      {{! <Hds::Button @text="Create" @icon="plus" @iconPosition="leading" @color="primary" /> }}
    </PH.Actions>
  {{/if}}
</Hds::PageHeader>

<PolicyForm
  @model={{this.model}}
  @onSave={{transition-to "vault.cluster.policy.show" this.model.policyType this.model.name}}
  @onCancel={{transition-to "vault.cluster.policy.show" this.model.policyType this.model.name}}
  @renderPolicyExampleModal={{true}}
/>