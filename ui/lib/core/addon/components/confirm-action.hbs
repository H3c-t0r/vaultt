{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: BUSL-1.1
~}}

{{#if @isInDropdown}}
  <Hds::Dropdown::ListItem::Interactive
    data-test-confirm-action-trigger
    @text={{@buttonText}}
    @color={{@buttonColor}}
    {{on "click" (fn (mut this.showConfirmModal) true)}}
    ...attributes
  />
{{else}}
  <Hds::Button
    data-test-confirm-action-trigger
    @text={{@buttonText}}
    @color={{@buttonColor}}
    {{on "click" (fn (mut this.showConfirmModal) true)}}
    ...attributes
  />
{{/if}}

{{#if this.showConfirmModal}}
  <Hds::Modal
    id="confirm-action-modal"
    @color={{or @modalColor "critical"}}
    @size="small"
    @onClose={{fn (mut this.showConfirmModal) false}}
    as |M|
  >
    <M.Header data-test-confirm-action-title @icon="alert-diamond">
      {{or @confirmTitle "Are you sure?"}}
    </M.Header>
    <M.Body>
      {{this.confirmMessage}}
    </M.Body>
    <M.Footer as |F|>
      <Hds::ButtonSet>
        <Hds::Button
          data-test-confirm-button
          disabled={{or @disabledMessage @isRunning}}
          @icon={{if @isRunning "loading"}}
          @color={{if (eq this.modalColor "critical") "critical" "primary"}}
          @text="Confirm"
          {{on "click" this.onConfirm}}
        />
        <Hds::Button data-test-confirm-cancel-button @color="secondary" @text="Cancel" {{on "click" F.close}} />
      </Hds::ButtonSet>
      {{#if @disabledMessage}}
        <Hds::Alert data-test-disabled-message class="has-top-margin-xs" @type="compact" as |A|>
          <A.Description> {{@disabledMessage}} </A.Description>
        </Hds::Alert>
      {{/if}}
    </M.Footer>
  </Hds::Modal>
{{/if}}