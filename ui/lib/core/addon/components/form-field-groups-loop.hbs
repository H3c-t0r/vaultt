{{#each @model.fieldGroups as |fieldGroup|}}
  {{#each-in fieldGroup as |group fields|}}
    {{#if (eq group "default")}}
      {{#each fields as |attr|}}
        {{! template-lint-configure simple-unless "warn"  }}
        {{#unless (and (not-eq @mode "create") (eq attr.name "name"))}}
          <FormField
            data-test-field={{true}}
            @attr={{attr}}
            @model={{@model}}
            @modelValidations={{@modelValidations}}
            @showHelpText={{@showHelpText}}
          >
            {{yield attr}}
          </FormField>
        {{/unless}}
      {{/each}}
    {{else}}
      {{#let (camelize (concat "show" group)) as |prop|}}
        <ToggleButton
          @isOpen={{get @model prop}}
          @openLabel={{concat "Hide " group}}
          @closedLabel={{group}}
          @onClick={{fn (mut (get @model prop))}}
          class="is-block"
          data-test-toggle-group={{group}}
        />
        {{#if (get @model prop)}}
          {{! Check if group is listed as a flexGroup }}
          {{#each this.flexGroups as |flexGroup|}}
            {{#if (eq flexGroup group)}}
              {{! if it is listed as a flexGroup then put within a flex container }}
              <div class="box is-marginless">
                <div class="is-grid is-grid-3-columns is-grid-4-rows is-medium-height is-row-gap-medium">
                  {{#each fields as |attr|}}
                    {{! the first item should be a label with explanation text that spans the entire grid }}
                    <div class={{if attr.options.isTitleOfFlexGroup "is-grid-column-span-3" ""}}>
                      <FormField
                        data-test-field={{true}}
                        @attr={{attr}}
                        @model={{@model}}
                        @modelValidations={{@modelValidations}}
                        @showHelpText={{@showHelpText}}
                      >
                        {{yield attr}}
                      </FormField>
                    </div>
                  {{/each}}
                </div>
              </div>
            {{else}}
              <div class="box is-marginless">
                {{#each fields as |attr|}}
                  {{! ARG TODO return to ask for help on how to move this up a level? }}
                  <FormField
                    data-test-field={{true}}
                    @attr={{if (eq attr.name "keyBits") @model.keyBitsConditional attr}}
                    @model={{@model}}
                    @modelValidations={{@modelValidations}}
                    @showHelpText={{@showHelpText}}
                  >
                    {{yield attr}}
                  </FormField>
                {{/each}}
              </div>
            {{/if}}
          {{/each}}
        {{/if}}
      {{/let}}
    {{/if}}
  {{/each-in}}
{{/each}}