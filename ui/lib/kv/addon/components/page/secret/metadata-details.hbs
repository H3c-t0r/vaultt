<KvPageHeader @breadcrumbs={{@breadcrumbs}} @model={{@model}} @pageTitle={{@model.path}}>
  <:tabLinks>
    <LinkTo @route="secret.details" data-test-secrets-tab="Secret">Secret</LinkTo>
    <LinkTo @route="secret.metadata.index" data-test-secrets-tab="Metadata">Metadata</LinkTo>
    <LinkTo @route="secret.metadata.versions" data-test-secrets-tab="Metadata">Version History</LinkTo>
    <LinkTo @route="secret.metadata.diff" data-test-secrets-tab="Metadata">Version Diff</LinkTo>
  </:tabLinks>

  <:toolbarActions>
    {{! You must have update on metadata, create is not enough to edit. }}
    {{#if this.model.canUpdateMetadata}}
      <ToolbarLink @route="secret.metadata.edit">Edit metadata</ToolbarLink>
    {{/if}}
  </:toolbarActions>
</KvPageHeader>

<div class="form-section">
  <label class="title is-5 has-top-padding-m">
    Custom metadata
  </label>
</div>
<div class="box is-fullwidth is-sideless is-paddingless is-marginless">
  {{#if this.canReadMetadata}}
    {{#if this.model.customMetadata}}
      {{#each-in this.model.customMetadata as |key value|}}
        <InfoTableRow @alwaysRender={{false}} @label={{key}} @value={{value}} />
      {{/each-in}}
    {{else}}
      <EmptyState
        @title="No custom metadata"
        @bottomBorder={{true}}
        @message="This data is version-agnostic and is usually used to describe the secret being stored."
      >
        {{#if this.model.canUpdateMetadata}}
          <LinkTo
            @route="vault.cluster.secrets.backend.kv.secret.metadata.edit"
            @model={{this.model.path}}
            data-test-add-custom-metadata
          >
            Add metadata
          </LinkTo>
        {{/if}}
      </EmptyState>
    {{/if}}
  {{else}}
    <EmptyState
      @title="You do not have access to read secret metadata"
      @message="In order to edit secret metadata, the UI requires read permissions; otherwise, data may be deleted. Edits can still be made via the API and CLI."
    />
  {{/if}}
</div>