<KvPageHeader @breadcrumbs={{@breadcrumbs}} @model={{@model}} @pageTitle="Edit Secret Metadata" />

<hr class="is-marginless has-background-gray-200" />
<p class="has-top-margin-m has-bottom-margin-m">
  The options below are all version-agnostic; they apply to all versions of this secret.
</p>
<form {{on "submit" (perform this.save)}}>
  <div class="box is-sideless is-fullwidth is-marginless">
    {{#each @model.formFields as |attr|}}
      <MessageError @errorMessage={{this.errorBanner}} class="has-top-margin-s" />
      <NamespaceReminder @mode="update" @noun="KV secret metadata" />
      {{#if (eq attr.name "customMetadata")}}
        <FormField @attr={{attr}} @model={{@model}} @modelValidations={{this.modelValidations}} />
        <label class="title has-top-padding-m is-4">
          Additional options
        </label>
      {{else if (not-eq attr.name "customMetadata")}}
        <FormField @attr={{attr}} @model={{@model}} @modelValidations={{this.modelValidations}} />
      {{/if}}
    {{/each}}
  </div>
  <div class="field is-grouped is-grouped-split is-fullwidth box is-bottomless">
    <div class="has-top-padding-s">
      <button
        type="submit"
        class="button is-primary {{if this.save.isRunning 'is-loading'}}"
        disabled={{this.save.isRunning}}
        data-test-kv-metadata-save
      >
        Update
      </button>
      <button
        type="button"
        class="button has-left-margin-s"
        disabled={{this.save.isRunning}}
        {{on "click" @onCancel}}
        data-test-kv-metadata-cancel
      >
        Cancel
      </button>
      {{#if this.modelValidations.targets.errors}}
        <AlertInline @type="danger" @message={{join ", " this.modelValidations.targets.errors}} @paddingTop={{true}} />
      {{/if}}
      {{#if this.invalidFormAlert}}
        <div class="control">
          <AlertInline @type="danger" @paddingTop={{true}} @message={{this.invalidFormAlert}} @mimicRefresh={{true}} />
        </div>
      {{/if}}
    </div>
  </div>

</form>