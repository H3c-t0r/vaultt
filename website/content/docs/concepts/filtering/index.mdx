---
layout: docs
page_title: Filtering
description: >-
  An introduction to the filtering syntax used in Vault.
---

# Filter expressions in Vault

Filter expressions use matching operators and selector values to parse
out important or relevant information. In some situations, you can use filter
expressions to control how Vault processes results.

## Filter expression syntax

Basic filter expressions are always written in plain text with a
**matching operator**, a **selector**, and a **selector value**.

- the **matching operator** tells Vault how to compare the selector and selector
  value.
- the **selector** is a [JSON pointer](https://tools.ietf.org/html/rfc6901) that
  indicates which field or parameter in a JSON object to consider.
- the **selector value** is a JSON pointer, number, or string that defines a
  pattern Vault can filter against.

For example, in the filter expression:

```text
product/name == "Vault"
```

- Equality (`==`) is the matching operator.
- The JSON pointer `product/name` is the selector.
- The string "Vault" is the selector value.

Complex filter expressions also allow Boolean logic and parenthesis. For example:

```text
(product/name == "Vault") and (timestamp < "2024-02-01") 
```

When parsing filter expressions, Vault ignores whitespace unless the whitespace
is part of a literal string.

Filter expression 
`product/name=="Vault"` and `product/name == "Vault"` generate the same results
while `product/name == " Vault "` and `product/name == "Vault"` generate
different results.

<Note title="Selectors are not universal">

  Filtering-enabled endpoints can support different selectors. Make sure to
  consult the API documentation for a given endpoint when constructing your
  filter expressions.

</Note>
<Tabs>

<Tab heading="Matching operators">



```text
// Equality & Inequality checks
<Selector> == "<Value>"
<Selector> != "<Value>"

// Emptiness checks
<Selector> is empty
<Selector> is not empty

// Contains checks or Substring Matching
"<Value>" in <Selector>
"<Value>" not in <Selector>
<Selector> contains "<Value>"
<Selector> not contains "<Value>"

// Regular Expression Matching
<Selector> matches "<Value>"
<Selector> not matches "<Value>"
```

### Selectors

Selectors must be valid JSON pointers enclosed in quotes with a  leading slash (`/`).

```text
// Selects the value `zipzap` from the input `{ "foo": { "bar": "zipzap" } }`
"/foo/bar"
```

### Values

Values are used by matching operators to create an expression. Values can be any
valid selector, a number, or a string. It is best practice to quote values.

Numbers can be base 10 integers or floating point numbers.

When quoting strings, they may either be enclosed in double quotes or backticks.
When enclosed in backticks they are treated as raw strings and escape sequences
such as `\n` will not be expanded.

## Connect expressions

There are several methods for connecting expressions, including

- Logical `or`
- Logical `and`
- Logical `not`
- Grouping with parenthesis
- Matching expressions

```text
// Logical Or - evaluates to true if either sub-expression does
<Expression 1> or <Expression 2>

// Logical And - evaluates to true if both sub-expressions do
<Expression 1 > and <Expression 2>

// Logical Not - evaluates to true if the sub-expression does not
not <Expression 1>

// Grouping - Overrides normal precedence rules
( <Expression 1> )

// Inspects data to check for a match
<Matching Expression 1>
```

Standard operator precedence can be expected for the various forms. For example,
the following two expressions would be equivalent.

```text
<Expression 1> and not <Expression 2> or <Expression 3>

( <Expression 1> and (not <Expression 2> )) or <Expression 3>
```

## Performance

Filters consume a portion  of CPU time on the Vault node where they run.

<Note title="Regular expressions">
  Using multiple/complex expressions including regular expressions
  (regex) will have a larger impact on performance than fewer/simpler filters.
</Note>

We recommend that all filters are tested in pre-production environments in order
to ensure correctness.

Ideally you should [codify your management of Vault](/vault/tutorials/operations/codify-mgmt-vault-terraform)
using tools such as [Terraform](https://www.terraform.io/), to prevent accidentally enabling an audit device
in a production environment with untested/incorrect settings.

Finally, always ensure you profile production-like workloads within your pre-production
environments in order to accurately assess the performance of Vault.
