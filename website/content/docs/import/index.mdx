---
layout: docs
page_title: Secrets import
description: Secrets import allows you to safely onboard secrets from external sources into Vault KV for management.
---


# Secrets import

<EnterpriseAlert product="vault" />

@include 'alerts/beta.mdx'

Distributing sensitive information across multiple external systems creates
several challenges, including:

- increased operational overhead.
- increased exposure risk from data sprawl.
- increased risk of outdated and out-of-sync information.

Using Vault as a single source of truth (SSOT) for sensitive data increases
security and reduces management overhead, but migrating data from multiple and
varied sources can be complex and costly. 

The secrets import process helps you automate and streamline your data
migration with codified import plans as HCL files. Import plans tell Vault
which data to read from a given source and where to store the data in the KVv2
secrets engine:

- the `source` block provides credentials for connecting to the source system.
- the `destination` block defines target mounts in KVv2.
- the `mapping` block define how Vault should transform the imported data before
  writing the information to KVv2.

## Data migration destinations

Vault stores imported secrets in a Vault KVv2 secrets engine mount. Destination
blocks start with `destination_vault` and define the desired KVv2 mount path and
an optional namespace. The combination of a path and namespace represent the exact location in your
Vault instance you want the information stored.

### HCL syntax


```hcl
destination_vault {
  name      = "my-dest-1"
  namespace = "ns-1"
  mount     = "mount-1"
}
```

- `name (string: <required>)` - A unique name for the destination block that can
  be referenced in subsequent mapping blocks.

- `address (string)` - Optional network address of the Vault server with the
  KVv2 secrets engine enabled.

- `token (string)` - Optional authentication token for the Vault server at the
  specified address.

- `namespace (string)` - Optional namespace path containing the specified KVv2
  mount. By default, Vault looks for the KVv2 mount under the root namespace.

- `mount (string)` - Optional mount path for the target KVv2 instance.



## Data migration sources

Vault can import secrets from the following sources:
- [GCP Secret Manager](/vault/docs/import/gcpsm)

To pull data from a source during import, Vault needs read credentials for the
external system. You can provide credentials directly as part of the import
plan, or use Vault to generate dynamic credentials for the importer if you already
have dynamic credentials configured for the corresponding secrets engine.

### HCL syntax

Source blocks start with `source_<external_system>` and include any connection
information required by the target system or engine. For example:

```hcl
source_gcp {
  name = "my-gcp-source-1"
  credentials = "@/path/to/service-account-key.json"
}
```

- `name (string: <required>)` - A unique name for the source block that can be
  referenced in subsequent mapping blocks.

- `credentials (string: <required>)` - Path to a credential file or token with
  read permissions for the target system.

Depending on the source system, additional information may be required. Refer to
the connection documentation for your source system to determine the full set of
required fields for that system type.



## Data migration mappings

Mappings glue the source and destination together and filter the migrated data
to control what is imported and what is ignored. Vault currently supports the
following mapping methods:

- [mapping_passthrough](/vault/docs/import/mappings#passthrough)
- [mapping_metadata](/vault/docs/import/mappings#metadata)
- [mapping_regex](/vault/docs/import/mappings#regex)

### HCL syntax

Mapping blocks start with `mapping_<filter_type>` and include a source name,
destination name, and any transformations or filters that apply. For example:

```hcl
mapping_regex {
  name        = "my-map-1"
  source      = "my-gcp-source-1"
  destination = "my-dest-1"
  priority    = 1
  expression  = "^database/.*$"
}
```

- `name (string: <required>)` - A unique name for the mapping block.

- `source (string: <required>)` - The name of a previously defined source block
  **from** which the data should be read.

- `destination (string: <required>)` - The name of a previously defined
  destination block **to** which the data should be written.

- `priority (integer: <required>)` - The order in which Vault should apply the
  mapping block during the import process. The lower the number, the higher the
  priority. For example, a mapping with priority 1 executes before a mapping
  with priority 2.

Depending on the filter type, additional fields may be required/possible. Refer
to the filter documentation for the different mappings for a list of
mapping-specific fields.

<Tip title="Priority matters">

  Vault applies mapping definitions in priority order and a given secret only
  matches to the first mapping that applies. Once Vault imports a secret with a
  particular mapping, subsequent reads from the same source will ignore that
  secret.

</Tip>
