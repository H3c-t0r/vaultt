## Issuing certificates

The following API endpoints allow users or operators to request certificates
and are all authenticated.

In general, for self-serve use, the `/pki/sign/:name` and `/pki/issue/:name`
are sufficient to allow most users to access for ACL purposes. The per-issuer
variants (`/pki/issuer/:issuer_ref/sign/:name` and
`/pki/issuer/:issuer_ref/issue/:name`) allow the requester to override the
role's chosen issuer, potentially allowing users to request certificates
issued by the wrong parent authority.

Some API endpoints included here are privileged and should only be accessed
by trusted users or operators; these include the various `sign-verbatim`,
`sign-self-signed` and `sign-intermediate` endpoints.

If an issued certificate has been compromised, it should be revoked. The
Vault PKI secrets engine presently only allows revocation by serial number;
because this could allow users to deny access to other users, it should be
restricted to operators.

### List roles

This endpoint returns a list of available roles. Only the role names are
returned, not any values. It is useful to both operators and users.

| Method | Path         |
| :----- | :----------- |
| `LIST` | `/pki/roles` |

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request LIST \
    http://127.0.0.1:8200/v1/pki/roles
```

#### Sample response

```json
{
  "auth": null,
  "data": {
    "keys": ["dev", "prod"]
  },
  "lease_duration": 0,
  "lease_id": "",
  "renewable": false
}
```

### Read role

This endpoint queries the role definition. It is useful to both operators and
users.

| Method | Path               |
| :----- | :----------------- |
| `GET`  | `/pki/roles/:name` |

#### Parameters

- `name` `(string: <required>)` - Specifies the name of the role to read. This
  is part of the request URL.

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/pki/roles/my-role
```

#### Sample response

```json
{
  "data": {
    "allow_any_name": false,
    "allow_ip_sans": true,
    "allow_localhost": true,
    "allow_subdomains": false,
    "allowed_domains": ["example.com", "foobar.com"],
    "allowed_uri_sans": ["example.com", "spiffe://*"],
    "allowed_other_sans": [
      "1.3.6.1.4.1.311.20.2.3;utf8:devops@example.com",
      "1.3.6.1.4.1.311.20.2.4;UTF-8:*"
    ],
    "client_flag": true,
    "code_signing_flag": false,
    "key_bits": 2048,
    "key_type": "rsa",
    "ttl": "6h",
    "max_ttl": "12h",
    "server_flag": true,
    ... additional fields elided ...
  }
}
```

<a name="generate-certificate"></a>

### Generate certificate and key

This endpoint generates a new set of credentials (private key and certificate)
based on the role named in the endpoint. The issuing CA certificate and full CA
chain is returned as well, so that only the root CA need be in a client's trust
store. Choice of issuing CA is determined first by the role (when using the
`/pki/issue/:name` path) and then by the path (when using the
`/pki/issuer/:issuer_ref/issue/name` path).

It is suggested to limit access to the path-overridden issue endpoint (on
`/pki/issuer/:issuer_ref/issue/:name`).

~> **Note**: The private key is _not_ stored. If you do not save the private
   key from the response, you will need to request a new certificate.

| Method | Path                                  | Issuer        |
| :----- | :------------------------------------ | :------------ |
| `POST` | `/pki/issue/:name`                    | Role selected |
| `POST` | `/pki/issuer/:issuer_ref/issue/:name` | Path selected |

#### Parameters

- `name` `(string: <required>)` - Specifies the name of the role to create the
  certificate against. This is part of the request URL.

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/issue/:name` path and
   takes its value from the role's `issuer_ref` field.

- `common_name` `(string: "")` - Specifies the requested CN for the
  certificate. If the CN is allowed by role policy, it will be issued. If more
  than one `common_name` is desired, specify the alternative names in the
  `alt_names` list.

~> Note: A value for `common_name` is required when [require_cn](#require_cn) is set to `true`

- `alt_names` `(string: "")` - Specifies requested Subject Alternative Names, in
  a comma-delimited list. These can be host names or email addresses; they will
  be parsed into their respective fields. If any requested names do not match
  role policy, the entire request will be denied.

- `ip_sans` `(string: "")` - Specifies requested IP Subject Alternative Names,
  in a comma-delimited list. Only valid if the role allows IP SANs (which is the
  default).

- `uri_sans` `(string: "")` - Specifies the requested URI Subject Alternative
  Names, in a comma-delimited list. If any requested URIs do not match role policy,
  the entire request will be denied.

- `other_sans` `(string: "")` - Specifies custom OID/UTF8-string SANs. These
  must match values specified on the role in `allowed_other_sans` (see role
  creation for allowed_other_sans globbing rules).
  The format is the same as OpenSSL: `<oid>;<type>:<value>` where the
  only current valid type is `UTF8`. This can be a comma-delimited list or a
  JSON string slice.

- `ttl` `(string: "")` - Specifies requested Time To Live. Cannot be greater
  than the role's `max_ttl` value. If not provided, the role's `ttl` value will
  be used. Note that the role values default to system values if not explicitly
  set. See `not_after` as an alternative for setting an absolute end date
  (rather than a relative one).

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`; defaults to `pem`. If `der`, the output is
  base64 encoded. If `pem_bundle`, the `certificate` field will contain the
  private key and certificate, concatenated; if the issuing CA is not a
  Vault-derived self-signed root, this will be included as well.

- `private_key_format` `(string: "der")` - Specifies the format for marshaling
  the private key within the private_key response field. Defaults to `der` which will
  return either base64-encoded DER or PEM-encoded DER, depending on the value of
  `format`. The other option is `pkcs8` which will return the key marshalled as
  PEM-encoded PKCS8.

~> **Note** that this does not apply to the private key within the certificate
  field if `format=pem_bundle` parameter is specified.

- `exclude_cn_from_sans` `(bool: false)` - If true, the given `common_name` will
  not be included in DNS or Email Subject Alternate Names (as appropriate).
  Useful if the CN is not a hostname or email address, but is instead some
  human-readable identifier.

- `not_after` `(string)` - Set the Not After field of the certificate with
  specified date value. The value format should be given in UTC format
  `YYYY-MM-ddTHH:MM:SSZ`. Supports the Y10K end date for IEEE 802.1AR-2018
  standard devices, `9999-12-31T23:59:59Z`.

- `remove_roots_from_chain` `(bool: false)` - If true, the returned `ca_chain`
  field will not include any self-signed CA certificates. Useful if end-users
  already have the root CA in their trust store.

- `user_ids` `(string: "")` - Specifies the comma-separated list of requested
  User ID (OID 0.9.2342.19200300.100.1.1) Subject values to be placed on the
  signed certificate. This field is validated against `allowed_user_ids` on
  the role.

#### Sample payload

```json
{
  "common_name": "www.example.com"
}
```

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/pki/issue/my-role
```

#### Sample response

```json
{
  "lease_id": "pki/issue/test/7ad6cfa5-f04f-c62a-d477-f33210475d05",
  "renewable": false,
  "lease_duration": 21600,
  "data": {
    "expiration": "1654105687",
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "private_key": "-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAnVHfwoKsUG1GDVyWB1AFroaKl2ImMBO8EnvGLRrmobIkQvh+\n...\nQN351pgTphi6nlCkGPzkDuwvtxSxiCWXQcaxrHAL7MiJpPzkIBq1\n-----END RSA PRIVATE KEY-----\n",
    "private_key_type": "rsa",
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:58"
  },
  "warnings": "",
  "auth": null
}
```

### Generate certificate and key with external policy <EnterpriseAlert inline="true" />

Similar to the [generate certificate and key](#generate-certificate-and-key)
endpoint, this endpoint generate key material and certificate via an external
policy engine. The private key material stays local to Vault, with the external
service getting only an empty CSR. Any parameters passed to this endpoint are
passed verbatim to the CIEPS engine <EnterpriseAlert inline="true" />. The
response format is the same between both endpoints.

It is suggested to limit access to the path-overridden issue endpoint (on
`/pki/issuer/:issuer_ref/external-policy/issue/:policy`) and let the CIEPS
engine override the issuer as necessary.

| Method | Path                                                      | Issuer                      |
| :----- |:----------------------------------------------------------| :-------------------------- |
| `POST` | `/pki/external-policy/issue(/:policy)`                    | `default` or CIEPS-selected |
| `POST` | `/pki/issuer/:issuer_ref/external-policy/issue(/:policy)` | Path or CIEPS selected      |

#### Parameters

- `policy` `(string: <optional>)` - Specifies the name of the policy to create
  the certificate against. This is part of the request URL and is passed to the
  external CIEPS engine.

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/external-policy/sign/:policy`
   path and takes its value from the CIEPS engine response's `issuer_ref`
   field, which can override the user-requested issuer.

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`; defaults to `pem`. If `der`, the output is
  base64 encoded. If `pem_bundle`, the `certificate` field will contain the
  private key and certificate, concatenated; if the issuing CA is not a
  Vault-derived self-signed root, this will be included as well.

- `key_type` `(string: "rsa")` - Specifies the desired key type; must be `rsa`, `ed25519`
  or `ec`.

~> **Note**: In FIPS 140-2 mode, the following algorithms are not certified
   and thus should not be used: `ed25519`.

- `key_bits` `(int: 0)` - Specifies the number of bits to use for the
  generated keys. Allowed values are 0 (universal default); with
  `key_type=rsa`, allowed values are: 2048 (default), 3072, or
  4096; with `key_type=ec`, allowed values are: 224, 256 (default),
  384, or 521; ignored with `key_type=ed25519`.

- `private_key_format` `(string: "der")` - Specifies the format for marshaling
  the private key within the private_key response field. Defaults to `der` which will
  return either base64-encoded DER or PEM-encoded DER, depending on the value of
  `format`. The other option is `pkcs8` which will return the key marshalled as
  PEM-encoded PKCS8.

~> **Note** that this does not apply to the private key within the certificate
  field if `format=pem_bundle` parameter is specified.


- `remove_roots_from_chain` `(bool: false)` - If true, the returned `ca_chain`
  field will not include any self-signed CA certificates. Useful if end-users
  already have the root CA in their trust store.

Other parameters may be specified and will not be parsed by Vault but may be
recognized based on external CIEPS engine definition.

#### Sample payload

```json
{
  "common_name": "example.com",
  "key_type": "rsa",
  "key_bits": 2048
}
```

#### Sample response

```json
{
  "lease_id": "",
  "renewable": false,
  "lease_duration": 0,
  "data": {
    "expiration": "1654105687",
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:52"
  },
  "auth": null
}
```

### Sign certificate

This endpoint signs a new certificate based upon the provided CSR and the
supplied parameters, subject to the restrictions contained in the role named in
the endpoint. The issuing CA certificate and the full CA chain is returned as
well, so that only the root CA need be in a client's trust store.

It is suggested to limit access to the path-overridden sign endpoint (on
`/pki/issuer/:issuer_ref/sign/:name`).

| Method | Path                                 | Issuer        |
| :----- | :----------------------------------- | :------------ |
| `POST` | `/pki/sign/:name`                    | Role selected |
| `POST` | `/pki/issuer/:issuer_ref/sign/:name` | Path selected |

#### Parameters

- `name` `(string: <required>)` - Specifies the name of the role to create the
  certificate against. This is part of the request URL.

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/sign/:name` path and
   takes its value from the role's `issuer_ref` field.

- `csr` `(string: <required>)` - Specifies the PEM-encoded CSR.

- `common_name` `(string: <required>)` - Specifies the requested CN for the
  certificate. If the CN is allowed by role policy, it will be issued. If
  more than one `common_name` is desired, specify the alternative names in
  the `alt_names` list.

- `alt_names` `(string: "")` - Specifies the requested Subject Alternative
  Names, in a comma-delimited list. These can be host names or email addresses;
  they will be parsed into their respective fields. If any requested names do
  not match role policy, the entire request will be denied.

- `other_sans` `(string: "")` - Specifies custom OID/UTF8-string SANs. These
  must match values specified on the role in `allowed_other_sans` (see role
  creation for allowed_other_sans globbing rules).
  The format is the same as OpenSSL: `<oid>;<type>:<value>` where the
  only current valid type is `UTF8`. This can be a comma-delimited list or a
  JSON string slice.

- `ip_sans` `(string: "")` - Specifies the requested IP Subject Alternative
  Names, in a comma-delimited list. Only valid if the role allows IP SANs (which
  is the default).

- `uri_sans` `(string: "")` - Specifies the requested URI Subject Alternative
  Names, in a comma-delimited list. If any requested URIs do not match role policy,
  the entire request will be denied.

- `ttl` `(string: "")` - Specifies the requested Time To Live. Cannot be greater
  than the role's `max_ttl` value. If not provided, the role's `ttl` value will
  be used. Note that the role values default to system values if not explicitly
  set. See `not_after` as an alternative for setting an absolute end date
  (rather than a relative one).

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`. If `der`, the output is base64 encoded. If
  `pem_bundle`, the `certificate` field will contain the certificate and, if the
  issuing CA is not a Vault-derived self-signed root, it will be concatenated
  with the certificate.

- `exclude_cn_from_sans` `(bool: false)` - If true, the given `common_name` will
  not be included in DNS or Email Subject Alternate Names (as appropriate).
  Useful if the CN is not a hostname or email address, but is instead some
  human-readable identifier.

- `not_after` `(string)` - Set the Not After field of the certificate with
  specified date value. The value format should be given in UTC format
  `YYYY-MM-ddTHH:MM:SSZ`. Supports the Y10K end date for IEEE 802.1AR-2018
  standard devices, `9999-12-31T23:59:59Z`.

- `remove_roots_from_chain` `(bool: false)` - If true, the returned `ca_chain`
  field will not include any self-signed CA certificates. Useful if end-users
  already have the root CA in their trust store.

- `user_ids` `(string: "")` - Specifies the comma-separated list of requested
  User ID (OID 0.9.2342.19200300.100.1.1) Subject values to be placed on the
  signed certificate. This field is validated against `allowed_user_ids` on
  the role.

#### Sample payload

```json
{
  "csr": "...",
  "common_name": "example.com"
}
```

#### Sample response

```json
{
  "lease_id": "pki/sign/test/7ad6cfa5-f04f-c62a-d477-f33210475d05",
  "renewable": false,
  "lease_duration": 21600,
  "data": {
    "expiration": "1654105687",
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:58"
  },
  "auth": null
}
```

### Sign certificate with external policy <EnterpriseAlert inline="true" />

Similar to the [sign certificate](#sign-certificate) endpoint, this endpoint
signs the specified leaf CSR via an external policy engine. Any parameters
passed to this endpoint are passed verbatim to the CIEPS
engine <EnterpriseAlert inline="true" />. The response format is the same
between both endpoints.

It is suggested to limit access to the path-overridden sign endpoint (on
`/pki/issuer/:issuer_ref/external-policy/sign/:policy`) and let the CIEPS
engine override the issuer as necessary.

| Method | Path                                                     | Issuer                      |
| :----- |:---------------------------------------------------------| :-------------------------- |
| `POST` | `/pki/external-policy/sign(/:policy)`                    | `default` or CIEPS-selected |
| `POST` | `/pki/issuer/:issuer_ref/external-policy/sign(/:policy)` | Path or CIEPS selected      |

#### Parameters

- `policy` `(string: <optional>)` - Specifies the name of the policy to create
  the certificate against. This is part of the request URL and is passed to the
  external CIEPS engine.

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/external-policy/sign/:policy`
   path and takes its value from the CIEPS engine response's `issuer_ref`
   field, which can override the user-requested issuer.

- `csr` `(string: <required>)` - Specifies the PEM-encoded CSR.

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`; defaults to `pem`. If `der`, the output is
  base64 encoded. If `pem_bundle`, the `certificate` field will contain the
  private key and certificate, concatenated; if the issuing CA is not a
  Vault-derived self-signed root, this will be included as well.

- `private_key_format` `(string: "der")` - Specifies the format for marshaling
  the private key within the private_key response field. Defaults to `der` which will
  return either base64-encoded DER or PEM-encoded DER, depending on the value of
  `format`. The other option is `pkcs8` which will return the key marshalled as
  PEM-encoded PKCS8.

~> **Note** that this does not apply to the private key within the certificate
  field if `format=pem_bundle` parameter is specified.

- `remove_roots_from_chain` `(bool: false)` - If true, the returned `ca_chain`
  field will not include any self-signed CA certificates. Useful if end-users
  already have the root CA in their trust store.

Other parameters may be specified and will not be parsed by Vault but may be
recognized based on external CIEPS engine definition.

#### Sample payload

```json
{
  "csr": "...",
  "common_name": "example.com",
  "key_attestation": "..."
}
```

#### Sample response

```json
{
  "lease_id": "",
  "renewable": false,
  "lease_duration": 0,
  "data": {
    "expiration": "1654105687",
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:52"
  },
  "auth": null
}
```

### Sign intermediate

This endpoint uses the configured CA certificate to issue a certificate with
appropriate values for acting as an intermediate CA. Distribution points use the
values set via `config/urls`. Values set in the CSR are ignored unless
`use_csr_values` is set to true, in which case the values from the CSR are used
verbatim.

This endpoint can be used both when signing a Vault-backed intermediate or
when signing an externally-owned intermediate.

~> **Note**: This is a privileged endpoint, as callers are granted a new
   intermediate certificate, with which they can issue for arbitrary names.
   Access to this endpoint should be restricted by policy to only trusted
   operators.

| Method | Path                                        | Issuer    |
| :----- | :------------------------------------------ | :-------  |
| `POST` | `/pki/root/sign-intermediate`               | `default` |
| `POST` | `/pki/issuer/:issuer_ref/sign-intermediate` | Selected  |

#### Parameters

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/root/sign-intermediate`
   path and takes the value `default`.

- `csr` `(string: <required>)` - Specifies the PEM-encoded CSR to be signed.

- `common_name` `(string: <required>)` - Specifies the requested CN for the
  certificate. If more than one `common_name` is desired, specify the
  alternative names in the `alt_names` list.

- `alt_names` `(string: "")` - Specifies the requested Subject Alternative
  Names, in a comma-delimited list. These can be host names or email addresses;
  they will be parsed into their respective fields.

- `ip_sans` `(string: "")` - Specifies the requested IP Subject Alternative
  Names, in a comma-delimited list.

- `uri_sans` `(string: "")` - Specifies the requested URI Subject Alternative
  Names, in a comma-delimited list.

- `other_sans` `(string: "")` - Specifies custom OID/UTF8-string SANs. These
  must match values specified on the role in `allowed_other_sans` (see role
  creation for allowed_other_sans globbing rules).
  The format is the same as OpenSSL: `<oid>;<type>:<value>` where the
  only current valid type is `UTF8`. This can be a comma-delimited list or a
  JSON string slice.

- `ttl` `(string: "")` - Specifies the requested Time To Live (after which the
  certificate will be expired). This cannot be larger than the engine's max (or,
  if not set, the system max). However, this can be after the expiration of the
  signing CA. See `not_after` as an alternative for setting an absolute end date
  (rather than a relative one).

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`. If `der`, the output is base64 encoded. If
  `pem_bundle`, the `certificate` field will contain the certificate and, if the
  issuing CA is not a Vault-derived self-signed root, it will be concatenated
  with the certificate.

- `max_path_length` `(int: -1)` - Specifies the maximum path length to encode in
  the generated certificate. `-1`, means no limit, unless the signing
  certificate has a maximum path length set, in which case the path length is
  set to one less than that of the signing certificate. A limit of `0` means a
  literal path length of zero.

- `exclude_cn_from_sans` `(bool: false)` - If true, the given `common_name` will
  not be included in DNS or Email Subject Alternate Names (as appropriate).
  Useful if the CN is not a hostname or email address, but is instead some
  human-readable identifier.

- `use_csr_values` `(bool: false)` - If set to `true`, then: 1) Subject
  information, including names and alternate names, will be preserved from the
  CSR rather than using the values provided in the other parameters to this
  path; 2) Any key usages (for instance, non-repudiation) requested in the CSR
  will be added to the basic set of key usages used for CA certs signed by this
  path; 3) Extensions requested in the CSR will be copied into the issued
  certificate.

- `permitted_dns_domains` `(string: "")` - A comma separated string (or, string
  array) containing DNS domains for which certificates are allowed to be issued
  or signed by this CA certificate. Supports subdomains via a `.` in front of
  the domain, as per [RFC 5280 Section 4.2.1.10 - Name
  Constraints](https://tools.ietf.org/html/rfc5280#section-4.2.1.10)

- `ou` `(string: "")` - Specifies the OU (OrganizationalUnit) values in the
  subject field of the resulting certificate. This is a comma-separated string
  or JSON array.

- `organization` `(string: "")` - Specifies the O (Organization) values in the
  subject field of the resulting certificate. This is a comma-separated string
  or JSON array.

- `country` `(string: "")` - Specifies the C (Country) values in the subject
  field of the resulting certificate. This is a comma-separated string or JSON
  array.

- `locality` `(string: "")` - Specifies the L (Locality) values in the subject
  field of the resulting certificate. This is a comma-separated string or JSON
  array.

- `province` `(string: "")` - Specifies the ST (Province) values in the subject
  field of the resulting certificate. This is a comma-separated string or JSON
  array.

- `street_address` `(string: "")` - Specifies the Street Address values in the
  subject field of the resulting certificate. This is a comma-separated string
  or JSON array.

- `postal_code` `(string: "")` - Specifies the Postal Code values in the
  subject field of the resulting certificate. This is a comma-separated string
  or JSON array.

- `serial_number` `(string: "")` -  - Specifies the requested Subject's named
  [Serial Number](https://datatracker.ietf.org/doc/html/rfc4519#section-2.31)
  value, if any. If you want more than one, specify alternative names in the
  `alt_names` map using OID 2.5.4.5. Note that this has no impact on the
  Certificate's serial number field, which Vault randomly generates.

- `not_before_duration` `(duration: "30s")` - Specifies the duration by which to
  backdate the NotBefore property. This value has no impact in the validity period
  of the requested certificate, specified in the `ttl` field.
  Uses [duration format strings](/vault/docs/concepts/duration-format).

- `not_after` `(string)` - Set the Not After field of the certificate with
  specified date value. The value format should be given in UTC format
  `YYYY-MM-ddTHH:MM:SSZ`. Supports the Y10K end date for IEEE 802.1AR-2018
  standard devices, `9999-12-31T23:59:59Z`.

- `signature_bits` `(int: 0)` - Specifies the number of bits to use in
  the signature algorithm; accepts 256 for SHA-2-256, 384 for SHA-2-384,
  and 512 for SHA-2-512. Defaults to 0 to automatically detect based
  on issuer's key length (SHA-2-256 for RSA keys, and matching the curve size
  for NIST P-Curves).

~> **Note**: ECDSA and Ed25519 issuers do not follow configuration of the
   `signature_bits` value; only RSA issuers will change signature types
   based on this parameter.

- `skid` `(string: "")` - Value for the Subject Key Identifier field
  (RFC 5280 Section 4.2.1.2). Specified as a string in hex format. Default
  is empty, allowing Vault to automatically calculate the SKID according
  to method one in the above RFC section.

~> **Note**: This value should ONLY be used when cross-signing to mimic
   the existing certificate's SKID value; this is necessary to allow
   certain TLS implementations (such as OpenSSL) which use SKID/AKID
   matches in chain building to restrict possible valid chains.

- `use_pss` `(bool: false)` - Specifies whether or not to use PSS signatures
  over PKCS#1v1.5 signatures when a RSA-type issuer is used. Ignored for
  ECDSA/Ed25519 issuers.

#### Sample payload

```json
{
  "csr": "...",
  "common_name": "example.com"
}
```

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/pki/root/sign-intermediate
```
#### Sample response

```json
{
  "lease_id": "",
  "renewable": false,
  "lease_duration": 0,
  "data": {
    "expiration": "1654105687",
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:58"
  },
  "auth": null
}
```

### Sign Intermediate with External Policy <EnterpriseAlert inline="true" />

Similar to [sign intermediate](#sign-intermediate), this endpoint accepts a
CSR and returns a certificate with appropriate values for acting as an
intermediate CA via an external policy engine. Any parameters passed to this
endpoint are passed verbatim to the CIEPS engine<EnterpriseAlert inline="true" />.
The response format is the same between both endpoints.

It is suggested to limit access to the path-overridden issue endpoint
(on /pki/issuer/:issuer_ref/external-policy/issue/:policy) and let the CIEPS
engine override the issuer as necessary.

| Method | Path                                                                | Issuer                    |
|--------|---------------------------------------------------------------------|---------------------------|
| POST   | /pki/external-policy/sign-intermediate(/:policy)                    | default or CIEPS-selected |
| POST   | /pki/issuer/:issuer_ref/external-policy/sign-intermediate(/:policy) | Path or CIEPS selected    |

#### Parameters

- `policy` `(string: <optional>)` - Specifies the name of the policy to create
  the certificate against. This is part of the request URL and is passed to the
  external CIEPS engine.

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/external-policy/sign-intermediate`
path and takes its value from the CIEPS engine response's `issuer_ref`
field, which can override the user-requested issuer.

- `csr` `(string: <required>)` - Specifies the PEM-encoded CSR.

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`; defaults to `pem`. If `der`, the output is
  base64 encoded. If `pem_bundle`, the `certificate` field will contain the
  private key and certificate, concatenated; if the issuing CA is not a
  Vault-derived self-signed root, this will be included as well.

- `private_key_format` `(string: "pem")` - Specifies the format for marshaling
  the private key within the private_key response field. Defaults to `der` which will
  return either base64-encoded DER or PEM-encoded DER, depending on the value of
  `format`. The other option is `pkcs8` which will return the key marshalled as
  PEM-encoded PKCS8.

~> **Note** that this does not apply to the private key within the certificate
field if `format=pem_bundle` parameter is specified.

Other parameters may be specified and will not be parsed by Vault but may be
recognized based on external CIEPS engine definition.

#### Sample payload

```json
{
  "csr": "..."
}
```

#### Sample response

```json
{
  "lease_id": "",
  "renewable": false,
  "lease_duration": 0,
  "data": {
    "expiration": "1654105687",
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:58"
  },
  "auth": null
}
```

### Sign Self-Issued

This endpoint uses the configured CA certificate to sign a self-issued
certificate (which will usually be a self-signed certificate as well).

~> **_This is an extremely privileged endpoint_**. The given certificate will be
   signed as-is with only minimal validation performed (is it a CA cert, and is it
   actually self-issued). The only values that will be changed will be the
   authority key ID, the issuer DN, and, if set, any distribution points.<br /><br />
   It is recommended to limit this endpoint to only trusted operators.

This is generally only needed for root certificate rolling in cases where you
don't want/can't get access to a CSR (such as if it's a root stored in Vault
where the key is not exposed). If you don't know whether you need this
endpoint, you most likely should be using a different endpoint (such as
`sign-intermediate`).

| Method | Path                                       | Issuer    | Requires `sudo` capability |
| :----- | :----------------------------------------- | :-------- | :------------------------- |
| `POST` | `/pki/root/sign-self-issued`               | `default` | yes                        |
| `POST` | `/pki/issuer/:issuer_ref/sign-self-issued` | Selected  | no                         |

#### Parameters

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/root/sign-self-issued`
   path and takes the value `default`.

- `certificate` `(string: <required>)` - Specifies the PEM-encoded self-issued certificate.

- `require_matching_certificate_algorithms` `(bool: false)` - If true, requires
that the public key algorithm of the CA match that of the submitted certificate.

#### Sample payload

```json
{
  "certificate": "..."
}
```

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/pki/root/sign-self-issued
```

#### Sample response

```json
{
  "lease_id": "",
  "renewable": false,
  "lease_duration": 0,
  "data": {
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
  },
  "auth": null
}
```

### Sign verbatim

This endpoint signs a new certificate based upon the provided CSR. Values are
taken verbatim from the CSR; the _only_ restriction is that this endpoint will
refuse to issue an intermediate CA certificate (see the
`/pki/root/sign-intermediate` endpoint for that functionality.)

**This is a potentially dangerous endpoint and only highly trusted users should
have access.**

| Method | Path                                            | Issuer    |
| :----- | :---------------------------------------------- | :-------- |
| `POST` | `/pki/sign-verbatim(/:name)`                    | `default` |
| `POST` | `/pki/issuer/:issuer_ref/sign-verbatim(/:name)` | Selected  |

#### Parameters

- `issuer_ref` `(string: <required>)` - Reference to an existing issuer,
  either by Vault-generated identifier, the literal string `default` to
  refer to the currently configured default issuer, or the name assigned
  to an issuer. This parameter is part of the request URL.

~> Note: This parameter is not present on the `/pki/root/sign-self-issued`
   path and takes the value `default`.

- `name` `(string: "")` - Specifies a role. If set, the following parameters
  from the role will have effect: `ttl`, `max_ttl`, `generate_lease`, `no_store` and `not_before_duration`.

- `csr` `(string: <required>)` - Specifies the PEM-encoded CSR.

- `key_usage` `(list: ["DigitalSignature", "KeyAgreement", "KeyEncipherment"])` -
  Specifies the default key usage constraint on the issued certificate. Valid
  values can be found at https://golang.org/pkg/crypto/x509/#KeyUsage - simply
  drop the `KeyUsage` part of the value. Values are not case-sensitive. To
  specify no default key usage constraints, set this to an empty list.

~> Note: previous versions of this document incorrectly called this a constraint;
   this value is only used as a default when the `KeyUsage` extension is missing
   from the CSR.

- `ext_key_usage` `(list: [])` -
  Specifies the default extended key usage constraint on the issued certificate. Valid
  values can be found at https://golang.org/pkg/crypto/x509/#ExtKeyUsage - simply
  drop the `ExtKeyUsage` part of the value. Values are not case-sensitive. To
  specify no key default usage constraints, set this to an empty list.

~> Note: previous versions of this document incorrectly called this a constraint;
   this value is only used as a default when the `ExtendedKeyUsage` extension is
   missing from the CSR.

- `ext_key_usage_oids` `(string: "")` - A comma-separated string or list of extended key usage oids.

~> Note: This value is only used as a default when the `ExtendedKeyUsage`
   extension is missing from the CSR.

- `ttl` `(string: "")` - Specifies the requested Time To Live. Cannot be greater
  than the engine's `max_ttl` value. If not provided, the engine's `ttl` value
  will be used, which defaults to system values if not explicitly set. See
  `not_after` as an alternative for setting an absolute end date (rather than
  a relative one).

- `format` `(string: "pem")` - Specifies the format for returned data. Can be
  `pem`, `der`, or `pem_bundle`. If `der`, the output is base64 encoded. If
  `pem_bundle`, the `certificate` field will contain the certificate and, if the
  issuing CA is not a Vault-derived self-signed root, it will be concatenated
  with the certificate.

- `not_after` `(string)` - Set the Not After field of the certificate with
  specified date value. The value format should be given in UTC format
  `YYYY-MM-ddTHH:MM:SSZ`. Supports the Y10K end date for IEEE 802.1AR-2018
  standard devices, `9999-12-31T23:59:59Z`.

- `signature_bits` `(int: 0)` - Specifies the number of bits to use in
  the signature algorithm; accepts 256 for SHA-2-256, 384 for SHA-2-384,
  and 512 for SHA-2-512. Defaults to 0 to automatically detect based
  on issuer's key length (SHA-2-256 for RSA keys, and matching the curve size
  for NIST P-Curves).

~> **Note**: ECDSA and Ed25519 issuers do not follow configuration of the
   `signature_bits` value; only RSA issuers will change signature types
   based on this parameter.

- `use_pss` `(bool: false)` - Specifies whether or not to use PSS signatures
  over PKCS#1v1.5 signatures when a RSA-type issuer is used. Ignored for
  ECDSA/Ed25519 issuers.

- `remove_roots_from_chain` `(bool: false)` - If true, the returned `ca_chain`
  field will not include any self-signed CA certificates. Useful if end-users
  already have the root CA in their trust store.

- `user_ids` `(string: "")` - Specifies the comma-separated list of requested
  User ID (OID 0.9.2342.19200300.100.1.1) Subject values to be placed on the
  signed certificate. No validation on names is performed using this endpoint.

#### Sample payload

```json
{
  "csr": "..."
}
```

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/pki/sign-verbatim
```

#### Sample response

```json
{
  "lease_id": "pki/sign-verbatim/7ad6cfa5-f04f-c62a-d477-f33210475d05",
  "renewable": false,
  "lease_duration": 21600,
  "data": {
    "certificate": "-----BEGIN CERTIFICATE-----\nMIIDzDCCAragAwIBAgIUOd0ukLcjH43TfTHFG9qE0FtlMVgwCwYJKoZIhvcNAQEL\n...\numkqeYeO30g1uYvDuWLXVA==\n-----END CERTIFICATE-----\n",
    "issuing_ca": "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n",
    "ca_chain": [
      "-----BEGIN CERTIFICATE-----\nMIIDUTCCAjmgAwIBAgIJAKM+z4MSfw2mMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\n...\nG/7g4koczXLoUM3OQXd5Aq2cs4SS1vODrYmgbioFsQ3eDHd1fg==\n-----END CERTIFICATE-----\n"
    ],
    "serial_number": "39:dd:2e:90:b7:23:1f:8d:d3:7d:31:c5:1b:da:84:d0:5b:65:31:58"
  },
  "auth": null
}
```

### Revoke certificate

This endpoint revokes a certificate using its serial number. This is an
alternative option to the standard method of revoking using Vault lease IDs. A
successful revocation will rotate the CRL.

~> **Note**: This operation is privileged as it allows revocation of arbitrary
   certificates based purely on their serial number. It does not validate that
   the requesting user issued the certificate or has possession of the private
   key.<br /><br />
   It is not possible to revoke issuers using this path.

| Method | Path          |
| :----- | :------------ |
| `POST` | `/pki/revoke` |

#### Parameters

~> Note: either `serial_number` or `certificate` (but not both) must be
   specified on requests to this endpoint.

- `serial_number` `(string: <optional>)` - Specifies the serial number of the
  certificate to revoke, in hyphen-separated or colon-separated hexadecimal.

- `certificate` `(string: <optional>)` - Specifies the certificate to revoke,
  in PEM format. This certificate must have been signed by one of the issuers
  in this mount in order to be accepted for revocation.

#### Sample payload

```json
{
  "serial_number": "39:dd:2e..."
}
```

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/pki/revoke
```

#### Sample response

```json
{
  "data": {
    "revocation_time": 1433269787
  }
}
```

### Revoke certificate with private key

This endpoint revokes a certificate using its private key as proof that the
request is authorized by an appropriate individual (Proof of Possession).

This is an alternative option to the standard method of revoking using Vault
lease IDs or revocation via serial number. A successful revocation will
rotate the CRL.

It is not possible to revoke issuers using this path.

~> **Note**: This operation is **NOT** privileged, as it validates revocation
   has a private key corresponding to a certificate signed by Vault. However,
   to avoid third parties performing a denial-of-service (DOS) against Vault,
   we've made this endpoint authenticated. Thus it is strongly encouraged to
   generally allow all access to this path via ACLs.

| Method | Path                   |
| :----- | :--------------------- |
| `POST` | `/pki/revoke-with-key` |

#### Parameters

~> Note: either `serial_number` or `certificate` (but not both) must be
   specified on requests to this endpoint.

- `serial_number` `(string: <optional>)` - Specifies the serial number of the
  certificate to revoke, in hyphen-separated or colon-separated hexadecimal.

- `certificate` `(string: <optional>)` - Specifies the certificate to revoke,
  in PEM format. This certificate must have been signed by one of the issuers
  in this mount in order to be accepted for revocation.

- `private_key` `(string: <required>)` - Specifies the private key (in PEM
  format) corresponding to the certificate issued by Vault that is attempted
  to be revoked. This endpoint must be called several times (with each unique
  certificate/serial number) if this private key is used in multiple
  certificates as Vault does not maintain such a mapping.

#### Sample payload

```json
{
  "serial_number": "39:dd:2e...",
  "private_key": "-----BEGIN PRIVATE KEY-----\n..."
}
```

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/pki/revoke-with-key
```

#### Sample response

```json
{
  "data": {
    "revocation_time": 1433269787
  }
}
```


### List revoked certificates

This endpoint returns a list of serial numbers that have been revoked on the local cluster.

| Method | Path              |
|:-------|:------------------|
| `LIST` | `/certs/revoked`  |

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request LIST \
    http://127.0.0.1:8200/v1/pki/certs/revoked
```

#### Sample response

```json
{
  "data": {
    "keys": [
      "3d:80:91:c3:c2:34:3b:81:69:3d:92:a3:80:69:db:53:04:26:ab:b4"
    ]
  }
}
```

### List revocation requests

This endpoint returns a list of serial numbers that have been requested to
be revoked on any cluster, along with information about the request's state
and which cluster it originated on.

| Method | Path                      |
| :----- | :------------------------ |
| `LIST` | `/certs/revocation-queue` |

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request LIST \
    http://127.0.0.1:8200/v1/pki/certs/revocation-queue
```

#### Sample response

```json
{
  "data": {
    "key_info": {
      "3d:80:91:c3:c2:34:3b:81:69:3d:92:a3:80:69:db:53:04:26:ab:b4": {
        "requesting_cluster": "48327b28-8325-6d79-6a0b-4cbaa6f27b4a"
      }
    },
    "keys": [
      "3d:80:91:c3:c2:34:3b:81:69:3d:92:a3:80:69:db:53:04:26:ab:b4"
    ]
  }
}
```

### List Cross-Cluster revocations

This endpoint returns a list of serial numbers that have been revoked on any
cluster, along with the clusters that have a copy of that revoked certificate.

| Method | Path                     |
| :----- | :----------------------- |
| `LIST` | `/certs/unified-revoked` |

#### Sample request

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request LIST \
    http://127.0.0.1:8200/v1/pki/certs/unified-revoked
```

#### Sample response

```json
{
  "data": {
    "key_info": {
      "7f:fd:12:5b:16:29:bb:28:ea:24:bc:a1:80:f7:4e:6e:a0:69:b9:95": {
        "revoking_clusters": [
          "48327b28-8325-6d79-6a0b-4cbaa6f27b4a"
        ]
      }
    },
    "keys": [
      "7f:fd:12:5b:16:29:bb:28:ea:24:bc:a1:80:f7:4e:6e:a0:69:b9:95"
    ]
  }
}
```
