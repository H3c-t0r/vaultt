### Performance Standbys revert to Standby mode on unseal

#### Affected versions

- 1.14.12
- 1.15.8
- 1.16.2

#### Issue

Upgrading to Vault versions 1.14.12, 1.15.8, and 1.16.2 will cause Performance
Standby nodes to attempt a storage write during unseal, resulting in a read-only
storage error:

```
[ERROR] core: performance standby post-unseal setup failed: error="cannot write to readonly storage"
```

This issue manifests due to the way upgrades are performed. New nodes added to a
cluster with an older versioned leader will see the leaderâ€™s storage entry and
attempt to update it with the new minimum value for `retention months`. This
storage write will result in a readonly error on the newly added nodes.

Performance Standby nodes will revert to Standby after upgrading. You can verify
the status of your cluster nodes by checking the
[/sys/health](/vault/api-docs/system/health) endpoint.

After a full upgrade is completed and the leader steps down, one of the standbys
with this new value will become the active node and begin replicating the new
value to all other nodes.

This means that the Standby nodes on the affected version will receive the
update and be able to unseal as Performance Standby nodes once the new leader is
elected.

Any new new node added to the cluster after the upgrade will also be able to
unseal as Performance Standbys.

Deployments that rely on scaling across Performance Standbys will now forward
all requests to the active node, increasing the utilization of the active node.

A fix for the read-only storage error has been prioritized and escalated. The
fix will be in releases 1.14.13, 1.15.9 and 1.16.3.

<Warning title="Important">
If you have already upgraded to versions 1.14.12, 1.15.8, or 1.16.2, please
refer to the workaround section for options.
</Warning>

#### Workaround

There are several workaround for this known issue.

If the active node has already been upgraded to the new version, do one of the following:

1. Stop/start the Standby nodes.
2. Add more nodes with the affected version to the cluster.

If the active node has not been upgraded to the new version, update the
`retention_months` value to `48` on the active node via the
[/sys/counters/config](/vault/api-docs/sys/counters/config) endpoint.
