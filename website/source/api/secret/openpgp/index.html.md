---
layout: "api"
page_title: "OpenPGP Secret Backend - HTTP API"
sidebar_current: "docs-http-secret-openpgp"
description: |-
  This is the API documentation for the Vault OpenPGP secret backend.
---

# OpenPGP Secret Backend HTTP API

This is the API documentation for the Vault OpenPGP secret backend. For general
information about the usage and operation of the OpenPGP backend, please see the
[OpenPGP backend documentation](/docs/secrets/openpgp/index.html).

This documentation assumes the OpenPGP backend is mounted at the `/openpgp` path
in Vault. Since it is possible to mount secret backends at any location, please
update your API calls accordingly.

## Create Key

This endpoint creates a new named PGP key.

| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `POST`   | `/openpgp/keys/:name`        | `204 (empty body)`     |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to create.
  This is specified as part of the URL.

- `generate` `(bool: true)` – Specifies if a key should be generated by Vault
  or if a key is being passed from another service.

- `real_name` `(string:"")` – Specifies the real name of the identity associated
  with the PGP key to create. Must not contain any of "()<>\x00". Only used if
  generate is true.

- `email` `(string:"")` – Specifies the email of the identity associated with
  the PGP key to create. Must not contain any of "()<>\x00". Only used if
  generate is true.

- `comment` `(string:"")` – Specifies the comment of the identity associated
  with the PGP key to create. Must not contain any of "()<>\x00". Only used
  if generate is true.

- `key` `(string: <required - if generate is false>)` – Specifies the ASCII-armored
  PGP private key to use. Only used if generate is false.

- `key_bits` `(int: 2048)` – Specifies the number of bits of the generated PGP
  key to use. Only used if generate is true.

- `exportable` `(bool: false)` – Specifies if the raw key is exportable.

### Sample Payload

```json
{
  "real_name": "John Doe",
  "email": "john.doe@example.com",
  "key_bits": 4096
}
```

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/openpgp/keys/my-key
```

### Sample Payload

```json
{
  "key": "-----BEGIN PGP PRIVATE KEY BLOCK-----\n\nlQOYBFmZe5wBCACx8caRJ+M8mKCrS7FdJ5kTdjApbvsx3ccPwvAQhtT2pIYkU\/ec\n...\naUNPVQgd7AF+MIuana8p6KeAXGS3fpiF4vIM0VoeWfEiO9rzdG0ilm16E61r9A==\n=+776\n-----END PGP PRIVATE KEY BLOCK-----\n"
}
```

### Sample request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/openpgp/keys/my-imported-key
```

## Read Key

This endpoint returns information about a named PGP key.

| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `GET`    | `/openpgp/keys/:name`        | `200 application/json` |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to read.
  This is specified as part of the URL.

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/openpgp/keys/my-key
```

### Sample Response


```json
{
  "data": {
    "exportable": false,
    "fingerprint": "b0b7e7ca0e4ba1a631d15196ef3331150a45bc4d",
    "public_key": "-----BEGIN PGP PUBLIC KEY BLOCK-----\n\nxsBNBFmZ6QQBCAC5QSHMKe6M9S2G9REo3sJuDPX2lm4ZMULXCvwcVekPYyUFWYI8\n...\nnTruSryJ4xYCydiJ1xkTedrkVxhh7hJKHA==\n=4fdy\n-----END PGP PUBLIC KEY BLOCK-----"
  }
}
```

## List Keys

This endpoint returns a list of keys. Only the key names are returned.

| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `LIST`   | `/openpgp/keys`              | `200 application/json` |

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request LIST \
    http://127.0.0.1:8200/v1/openpgp/keys
```

### Sample Response

```json
{
  "data": {
    "keys": ["foo", "bar"]
  }
}
```

## Delete Key

This endpoint deletes a named PGP key.

| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `DELETE` | `/openpgp/keys/:name`        | `204 (empty body)`     |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to delete.
  This is specified as part of the URL.

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request DELETE \
    http://127.0.0.1:8200/v1/openpgp/keys/my-key
```

## Export key

This endpoint returns the named PGP key ASCII-armored.
The key must be exportable to support this operation.


| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `GET`    | `/openpgp/export/:name`      | `200 application/json` |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to export.
  This is specified as part of the URL.

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/openpgp/export/my-key
```

### Sample Response

```json
{
  "data": {
    "name": "my-key",
    "key": "-----BEGIN PGP PRIVATE KEY BLOCK-----\n\nxcLYBFmZ7JwBCACxsatS8MKxvKpMspkl7ck4vvgZvijBu0sx7Z0+0QDAj8ej5gfK\n...\nYsnjj4QHSRbwJVs/WSIiAj39EyD+bQZDDDFqg62pUA==\n=j7B6\n-----END PGP PRIVATE KEY BLOCK-----"
  }
}
```

## Sign Data

This endpoint returns the signature of the given data using the
named PGP key and the specified hash algorithm.

| Method   | Path                               | Produces               |
| :------- | :--------------------------------- | :--------------------- |
| `POST`   | `/openpgp/sign/:name(/:algorithm)` | `200 application/json` |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to use for signing.
  This is specified as part of the URL.

- `algorithm` `(string: "sha2-256")` – Specifies the hash algorithm to use.
  This can also be specified as part of the URL.
  Valid algorithms are:

    - `sha2-224`
    - `sha2-256`
    - `sha2-384`
    - `sha2-512`

- `format` `(string: "base64")` – Specifies the encoding format for the
  returned signature. Valid encoding format are:

    - `base64`
    - `ascii-armor`

- `input` `(string: <required>)` – Specifies the **base64 encoded** input data.

### Sample Payload

```json
{
  "input": "QWxwYWNhCg=="
}
```

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/openpgp/sign/my-key/sha2-512
```

### Sample Response


```json
{
  "data": {
    "signature": "wsBcBAABCgAQBQJZme+7CRBr/Ej4JtFtLAAA8QcIACLtMWlH5860njpQsJZDIzH3T4mz2397lsd9/hsFDAQXEimuLKWmNdJsTEWXKGx1fvW+r6LEPs8HOLdzOMz2tq6M0WvgzHeWOFdEYmCapUlS68m0GnSFHIAFkq2fMVFHdTTmiLNuZwd+meEPL48hUO8QoGZLhS9IO+xOIisJWP+YIfiZBhmqhz0nVX3CnIzDZWAeJCE9TFGPHjFVNHXKN/IA+pdY4ntU1VOxmKCDqtu6qOrFR3ZghJBrDpDqiMHYmnJZ2AGPDVPKoAorvrLkR7eXNX71yRcutqohqS+xt6nGak2OF7UKwgj5bjk1y44lROFi8aVW4LEX7Jmt+2qwWBg="
  }
}
```

## Verify Signed Data


This endpoint returns whether the provided signature is valid for the given data.


| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `POST`   | `/openpgp/verify/:name`      | `200 application/json` |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key that was
  used signing. This is specified as part of the URL.

- `format` `(string: "base64")` – Specifies the encoding format the signature
  uses. Valid encoding format are:

    - `base64`
    - `ascii-armor`

- `input` `(string: <required>)` – Specifies the **base64 encoded** input data.

- `signature` `(string: "")` – Specifies the signature output from the
  `/openpgp/sign` function.


### Sample Payload

```json
{
  "input": "QWxwYWNhCg==",
  "signature": "wsBcBAABCgAQBQJZme+7CRBr/Ej4JtFtLAAA8QcIACLtMWlH5860njpQsJZDIzH3T4mz2397lsd9/hsFDAQXEimuLKWmNdJsTEWXKGx1fvW+r6LEPs8HOLdzOMz2tq6M0WvgzHeWOFdEYmCapUlS68m0GnSFHIAFkq2fMVFHdTTmiLNuZwd+meEPL48hUO8QoGZLhS9IO+xOIisJWP+YIfiZBhmqhz0nVX3CnIzDZWAeJCE9TFGPHjFVNHXKN/IA+pdY4ntU1VOxmKCDqtu6qOrFR3ZghJBrDpDqiMHYmnJZ2AGPDVPKoAorvrLkR7eXNX71yRcutqohqS+xt6nGak2OF7UKwgj5bjk1y44lROFi8aVW4LEX7Jmt+2qwWBg="
}
```

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/openpgp/verify/my-key
```

### Sample Response

```json
{
  "data": {
    "valid": true
  }
}
```

## Decrypt Data

This endpoint decrypts the provided ciphertext using the named PGP key.

| Method   | Path                         | Produces               |
| :------- | :--------------------------- | :--------------------- |
| `POST`   | `/openpgp/decrypt/:name`     | `200 application/json` |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to decrypt against.
  This is specified as part of the URL.

- `format` `(string: "base64")` – Specifies the encoding format the ciphertext uses.
  Valid encoding format are:

    - `base64`
    - `ascii-armor`

- `ciphertext` `(string: <required>)` – Specifies the ciphertext to decrypt.

- `signer_key` `(string: "")` – Specifies the PGP key ASCII-armored of the signer.
  If present, the ciphertext must be signed and the signature valid otherwise
  the decryption fail.


### Sample Payload

```json
{
  "format": "ascii-armor",
  "ciphertext": "-----BEGIN PGP MESSAGE-----\n\nhQEMA923ECy\/uCBhAQf8DLagsnoLuM4AyKiTyvZ7uSQTkmOkwXwn1WWsxoKJkzdI\n...\ne8iwFg==\n=+yfj\n-----END PGP MESSAGE-----"
}
```

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/openpgp/decrypt/my-key
```

#### Sample Response

```json
{
  "data": {
    "plaintext": "QWxwYWNhcwo="
  }
}
```

### Show Session Key

This endpoint decrypts and returns the session key of the provided ciphertext
using the named PGP key.

| Method   | Path                              | Produces               |
| :------- | :-------------------------------- | :--------------------- |
| `POST`   | `/openpgp/show-session-key/:name` | `200 application/json` |

### Parameters

- `name` `(string: <required>)` – Specifies the name of the key to decrypt against.
  This is specified as part of the URL.

- `format` `(string: "base64")` – Specifies the encoding format the ciphertext uses.
  Valid encoding format are:

    - `base64`
    - `ascii-armor`

- `ciphertext` `(string: <required>)` – Specifies the ciphertext to decrypt.

- `signer_key` `(string: "")` – Specifies the PGP key ASCII-armored of the signer.
  If present, the ciphertext must be signed and the signature valid otherwise
  the decryption fail.

### Sample Payload

```json
{
  "format": "ascii-armor",
  "ciphertext": "-----BEGIN PGP MESSAGE-----\n\nhQEMA923ECy\/uCBhAQf8DLagsnoLuM4AyKiTyvZ7uSQTkmOkwXwn1WWsxoKJkzdI\n...\ne8iwFg==\n=+yfj\n-----END PGP MESSAGE-----"
}
```

### Sample Request

```
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    http://127.0.0.1:8200/v1/openpgp/show-session-key/my-key
```

### Sample Response

```json
{
  "data": {
    "session_key": "9:720D9B92D50D4F7C404C8C412BEB73B47E0A2FA2E822C13201A79D5A2694F9F5"
  }
}
```
